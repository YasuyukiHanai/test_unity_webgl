let e=document.createElement("style");e.innerHTML="[data-v-72e5105f]{-webkit-tap-highlight-color:rgba(255,255,255,0)}.stop-long-hover[data-v-72e5105f]{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.max-w-1200[data-v-72e5105f]{max-width:1200px}",document.head.appendChild(e);import{s as a,a as t,b as n,c as i,L as s}from"./zh_cn.80f05546.js";import{c as r,a as l,t as o,e as m,F as h,o as c,r as d,b as p,g as u}from"./index.29050639.js";import{s as f}from"./farmInsetPanel.38dce68d.js";import"./stats.module.57945d58.js";class g{constructor(e){let a,t,n,i,s;a=e.getContext("2d"),t=e.width/2,n=e.height/2,i=2*Math.PI/100,s=.1,function r(){requestAnimationFrame(r),a.clearRect(0,0,e.width,e.height),a.save(),a.beginPath(),a.lineWidth=5,a.strokeStyle="blue",a.arc(t,n,100,0,2*Math.PI,!1),a.stroke(),a.closePath(),a.restore(),l=s,a.save(),a.strokeStyle="#fff",a.lineWidth=8,a.beginPath(),a.arc(t,n,100,-Math.PI/2,-Math.PI/2+l*i,!1),a.stroke(),a.closePath(),a.restore();var l}(),this.UpdateCircle=function(e){s=e}}}var y={name:"loadingpanel",components:{},data:()=>({canEnter:!1,diplayerLoading:!0,loadingCircleBar:null,loadingProcessValue:0,loading:!1,tipContent:"模型加载中，请稍候。。。",tipLater:null}),mounted(){this.loadingCircleBar=new g(this.$refs.circlebar)},methods:{LoadingState(e){"success"==e&&(this.loading=!1),"begin"==e&&(this.tipContent="模型加载中，请稍候。。。",this.loading=!0)},LoadState(e){"success"==e&&(this.canEnter=!0),"begin"==e&&(this.diplayerLoading=!0)},LoadingProcess(e){this.loadingProcessValue=e,this.loadingCircleBar.UpdateCircle(e)},OpenThreejs(){this.$parent.OpenThreejs(),this.diplayerLoading=!1}}};const P={key:0,class:"absolute w-full h-full top-0 left-0 flex pointer-events-none"},v={class:"w-1/2 h-10 text-2xl text-white mt-10 mx-auto"},x={key:1,class:"absolute w-full h-full top-0 left-0"},b={class:"absolute w-full h-full top-0 left-0 flex pointer-events-none"},C={class:"mx-auto self-center transform scale-50 -rotate-90",ref:"circlebar",width:"300",height:"300"},k={class:"absolute z-10 left-0 top-0 w-full h-full flex"},I={class:"w-20 h-20 mx-auto self-center flex"},S={key:0,class:"mx-auto self-center text-white"};y.render=function(e,a,t,n,i,s){return c(),r(h,null,[i.loading?(c(),r("div",P,[l("div",v,o(i.tipContent),1)])):m("",!0),i.diplayerLoading?(c(),r("div",x,[l("div",b,[l("canvas",C,null,512)]),l("div",k,[l("div",I,[i.canEnter?m("",!0):(c(),r("div",S,o(i.loadingProcessValue)+"% ",1)),i.canEnter?(c(),r("div",{key:1,class:"mx-auto self-center text-white cursor-pointer transform hover:scale-110",onClick:a[0]||(a[0]=e=>s.OpenThreejs())}," 进入 "+o(),1)):m("",!0)])])])):m("",!0)],64)};var M={roomName:"3dfarm",setting:{localPath:"farm/",cursorUrl:"",title:"线上农场",hasChangeCtrlState:!0,hasBGM:!1,BGMurl:"musicverse/bg.mp3",camZ:-8,camWheelMax:-30,righttopBtn:!1,keyC:!0,keyQ:!0,canEnableGravity:!0,upSpeed:4,flySpeed:10,hasEnvmap:!1,envmapPath:"",hasCamRaycast:!1,hasMinMap:!0,inMinMapEditor:!1,hasAerialView:!0,contrlState:1,wheelValue:-8,cameraOffset:{x:0,y:5,z:-7},moveSpeed:5,maxMoveSpeed:5,targetRota:{x:-1.25,y:1.3},playerHeight:1.7,camOffsetY:1.6},hotPointData:{triggerAreaRotaSpeed:.01},minMapData:{minMapUrl:"minMap.png",minMapPointUrl:"minMapPoint.png",minMapOffset:{x:-.0415,y:.007},minMapScale:{x:.0033,y:.0027},minMapPlanePos:{x:-0,y:-.45,z:-1}},AmbientLightData:{AmbientLightIntensity:1,DirectionalLightPos:{x:-50,y:100,z:1},DirectionalLightIntensity:1},defaultUser:{userName:"test",roomName:"3dfarm",platform:"pcweb",avatarName:"小孩"},sceneTexPath:"models/Scene/scene.txt",playerImgPath:[{name:"小孩",platform:"pcweb",img:"farm/images/player/10.png"},{name:"小孩2",platform:"pcweb",img:"farm/images/player/11.png"}],modelsList:[{name:"小孩",img:"farm/images/player/10.png",modelType:"角色"}],avatarData:[{name:"小孩",height:1.7,nameScale:1,modelScale:.01,img:"player/farmPlayer/farmPlayer.png",modelType:"角色",modelPath:"farmplayer/farmPlayerIdle.fbx",animationsData:[{clipIndex:0,animName:"idle",timeScale:1,connected:!1,targetIndex:1},{clipIndex:1,animName:"walk",timeScale:1,connected:!1,targetIndex:0},{clipIndex:2,animName:"jump",timeScale:2,connected:!1,targetIndex:0}]},{name:"小孩2",height:1.7,nameScale:1,modelScale:.03,img:"player/farmPlayer/farmPlayer.png",modelType:"角色",modelPath:"farmplayer/farmPlayer2.fbx",animationsData:[{clipIndex:0,animName:"idle",timeScale:1,connected:!1,targetIndex:0},{clipIndex:1,animName:"walk",timeScale:2,connected:!1,targetIndex:1},{clipIndex:2,animName:"jump",timeScale:1,connected:!1,targetIndex:0}]}]},D={name:"index",components:{ThreejsHumanChat:a,minMapEditor:t,loadingPanel:y,JoystickLeftPanel:n,JoystickRightPanel:i,farmInsetPanel:f},data:()=>({isInsertPanel:!1,displayUserNameUI:!1,jiaohuTip:!1,roomName:"",platform:"",selectPlayerName:"",playerImgPath:[],user:{pos:[-100,-100,0],rota:[0,0,0],rotateY:1,animName:"idle",playerData:{},userData:{}},userName:"",userId:"",id:"",hotPoint:[],pos:{x:-100,y:-100},isMobile:!1,playerDefaultX:0,playerDefaultY:0,language:null,isEn:!1,avatarData:null,contrlState:0}),created(){this.avatarData=M,this.language=s.languageCN,this.$publicUrl+=this.avatarData.setting.localPath},mounted(){this.playerImgPath=this.avatarData.playerImgPath,this.roomName=this.avatarData.roomName,this.selectPlayerName=this.avatarData.defaultUser.avatarName,this.contrlState=this.avatarData.setting.contrlState,document.title=this.avatarData.setting.title,this.ClickeSelectOK(),this.CheckInMobile(),this.isMobile&&this.InitJoytick()},methods:{CheckInMobile(){var e=navigator.userAgent.toLowerCase(),a=e.indexOf("ipad")>-1,t=e.indexOf("iphone")>-1,n=e.indexOf("midp")>-1,i=e.indexOf("rv:1.2.3.4")>-1,s=e.indexOf("ucweb")>-1,r=e.indexOf("android")>-1,l=e.indexOf("windows ce")>-1,o=e.indexOf("windows mobile")>-1,m=e.indexOf("mobile")>-1;this.isMobile=!!(a||t||n||i||s||r||l||m||o)},GetPublicUrl(){return this.$publicUrl},GetAvatarData(e){for(let a=0;a<this.avatarData.avatarData.length;a++)if(this.avatarData.avatarData[a].name==e)return this.avatarData.avatarData[a];return null},GetSceneTexPath(){return this.avatarData.sceneTexPath},GetMinMapData(){return this.avatarData.minMapData},GetNiaokanData(){},ClickNiaokan(){this.$refs.ThreejsHumanChat.YJController.ResetToNiaokanView()},SetMinMap(e,a,t,n){this.$refs.ThreejsHumanChat._YJSceneManager.SetMinMap(e,a,t,n)},SetCamPos(e,a,t,n,i,s){this.$refs.ThreejsHumanChat.YJController.SetCamNiaokanPos(e,a,t,n,i,s)},InitJoytick(){},ChangeTip(e){this.jiaohuTip=e},ClickeSelectOK(){this.user.playerData=this.playerImgPath[0];for(let e=0;e<this.playerImgPath.length;e++)this.selectPlayerName!=this.playerImgPath[e].name||(this.user.playerData=this.playerImgPath[e]);var e={userName:this.userName,roomName:this.roomName,platform:this.user.playerData.platform,modelType:this.user.playerData.name};this.$refs.ThreejsHumanChat.InitThreejs(this,e)},LoadingState(e){this.$refs.loadingPanel.LoadingState(e)},LoadState(e){this.$refs.loadingPanel.LoadState(e)},LoadingProcess(e){this.$refs.loadingPanel.LoadingProcess(e)},OpenThreejs(){this.$refs.ThreejsHumanChat._YJSceneManager.BeginEnter();let e=this.avatarData.setting.cursorUrl;""!=e&&(document.body.style.cursor="url("+this.$publicUrl+e+"),auto")},ClickJump(){this.$refs.ThreejsHumanChat.ClickJump()},ClickInteractive(){this.$refs.ThreejsHumanChat.ClickInteractive()},removeThreeJSfocus(){this.$refs.ThreejsHumanChat.removeEventListener()},addThreeJSfocus(){this.$refs.ThreejsHumanChat.threeJSfocus()}}};const w={key:0,class:"absolute z-20 left-0 bottom-8 w-full pointer-events-none"},T={key:2};D.render=function(e,a,t,n,i,s){const o=d("ThreejsHumanChat"),f=d("loadingPanel"),g=d("minMapEditor"),y=d("JoystickLeftPanel"),P=d("JoystickRightPanel"),v=d("farmInsetPanel");return c(),r(h,null,[p(o,{tabindex:"-1",class:"absolute left-0 top-0",ref:"ThreejsHumanChat",id:"ThreejsHumanChat"},null,512),p(f,{class:"absolute z-50 left-0 top-0",ref:"loadingPanel"},null,512),i.avatarData.setting.hasMinMap?(c(),r("div",w,[l("div",{class:"mx-auto w-60 h-36 bg-transparent pointer-events-auto",onClick:a[0]||(a[0]=e=>s.ClickNiaokan())})])):m("",!0),i.avatarData.setting.inMinMapEditor?(c(),u(g,{key:1})):m("",!0),i.isMobile&&0==i.contrlState?(c(),r("div",T,[p(y,{class:"",ref:"JoystickLeftPanel"},null,512),p(P,{class:"",ref:"JoystickRightPanel"},null,512)])):m("",!0),i.isInsertPanel?(c(),u(v,{key:3,ref:"farmInsetPanel"},null,512)):m("",!0)],64)},D.__scopeId="data-v-72e5105f";export{D as default};
