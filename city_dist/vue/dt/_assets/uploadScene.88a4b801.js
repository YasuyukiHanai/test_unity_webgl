import{r as e,c as t,a as l,b as a,w as s,d as o,t as i,e as n,o as r,F as c,f as d,g as h}from"./index.29050639.js";var p={components:{},data:()=>({error:!1,errorTip:"",selectProjectName:"farm",selectProjectPath:"",projectList:[{value:"farm",serverPath:"farm2/models/"},{value:"city",serverPath:"city/models/"}],publicUrl:"",fileName:"",fileList:[],fileSize:5,accept:".jpg,.jpeg,.bmp,.png,.bin,.gltf,.glb,.fbx,.FBX,.txt",loadTip:"加载中，请稍候。。。",loadCount:0,loadNum:0}),mounted(){this.publicUrl="C:/wamp/www/vue/dt/public/",this.OnGroupNameChange(this.selectProjectName)},methods:{change(){console.log(this.$refs.fileRef.files);let e=this.$refs.fileRef.files;this.loadCount=e.length;for(let t=0;t<e.length;t++)this.UploadFilesDire(e[t])},OnGroupNameChange(e){for(let t=0;t<this.projectList.length;t++){const l=this.projectList[t];l.value==e&&(this.selectProjectPath=l.serverPath)}console.log("in OnGroupNameChange "+this.selectProjectPath)},Upload(){},handleSuccess(e,t,l){console.log("文件上传成功")},handleBeforeUpload(e){this.UploadFiles(e)},UploadFiles(e){this.$uploadFile(e,this.publicUrl+this.selectProjectPath+"Scene",e.name,(e=>{console.log("上传文件后的返回值",e)}))},UploadFilesDire(e){let t=e.webkitRelativePath.replace("/"+e.name,""),l=this;this.$uploadFile(e,this.publicUrl+this.selectProjectPath+t,e.name,(e=>{console.log("上传文件后的返回值",e),l.loadNum++,l.loadNum>=l.loadCount&&console.log(" Scene文件夹全部上传完成")}))},SetErrorTip(e){this.error=!0,this.errorTip=e;let t=this;setTimeout((()=>{t.error=!1}),3e3)},Save(){if(0!=this.animations.length)if(this.animations.length<this.animationsData.length)for(let e=0;e<this.animationsData.length;e++){const t=this.animationsData[e];0==t.connected&&(t.connected=!0,t.targetIndex=0)}else for(let e=0;e<this.animationsData.length;e++){if(0==this.animationsData[e].connected)return void this.SetErrorTip("未全部指定标准动作")}},stringtoBlob(e,t){let l=new Blob([e],{type:"application/json"});return new File([l],t,{type:"application/json"})},SaveAnimationData(e){let t=JSON.stringify(e);console.log(t),this.$uploadFile(this.stringtoBlob(t,"test"),this.publicUrl+"models/players/"+this.cTime,this.currentTime+"_avatar.txt",(e=>{this.SetErrorTip("保存成功")}))},dataURLtoBlob(e,t){for(var l=e.split(","),a=l[0].match(/:(.*?);/)[1],s=atob(l[1]),o=s.length,i=new Uint8Array(o);o--;)i[o]=s.charCodeAt(o);return new File([i],t,{type:a})}}};const u={class:"absolute left-0 top-0 w-full h-full flex"},f={class:"relative self-center mx-auto w-3/4 h-3/4 bg-gray-100 rounded-md text-xs"},m=l("div",{class:"p-2 text-2xl"},"项目Scene文件上传",-1),g={class:"w-full h-5/6 flex"},v={class:"flex left-0 h-20"},b=l("div",{class:"px-2 self-center text-lg"},"项目名",-1),x={class:"self-center"},j={style:{}},w={class:"w-full flex text-xl h-10 mt-3"},P={class:"self-center mx-auto flex gap-x-5"},y=l("div",{class:"el-upload__text rounded-md shadow-md p-2 w-32 bg-gray-100 cursor-pointer"}," 上传文件 ",-1),U={style:{cursor:"pointer"}},S=l("span",{class:"upload-span"},"上传Scene文件夹",-1),N={key:0,class:"text-red-500"},C=l("div",{class:"absolute left-0 bottom-10 text-left p-5"},[l("div",null,"操作提示："),l("div",null,"1，选择项目名"),l("div",null,"2，首次上传，建议上传整个Scene文件夹"),l("div",null,"a)，单独上传文件只可选择Scene文件夹下的文件")],-1);p.render=function(p,F,T,D,B,L){const _=e("el-option"),O=e("el-select"),R=e("el-upload");return r(),t("div",u,[l("div",f,[m,l("div",g,[l("div",v,[b,l("div",x,[a(O,{modelValue:B.selectProjectName,"onUpdate:modelValue":F[0]||(F[0]=e=>B.selectProjectName=e),placeholder:"选择项目",onChange:L.OnGroupNameChange},{default:s((()=>[(r(!0),t(c,null,d(B.projectList,(e=>(r(),h(_,{key:e.value,label:e.value,value:e.value},{default:s((()=>[l("span",j,i(e.value),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])])]),l("div",w,[l("div",P,[a(R,{class:"bg-transparent",action:"",multiple:"","before-upload":L.handleBeforeUpload,accept:B.accept,"show-file-list":!1},{default:s((()=>[y])),_:1},8,["before-upload","accept"])]),l("div",U,[S,l("input",{ref:"fileRef",type:"file",name:"file",webkitdirectory:"",onChange:F[1]||(F[1]=o(((...e)=>L.change&&L.change(...e)),["stop"]))},null,544)])]),B.error?(r(),t("div",N,i(B.errorTip),1)):n("",!0),C])])};export{p as default};
