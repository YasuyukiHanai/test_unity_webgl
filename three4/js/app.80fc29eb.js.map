{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?4a62","webpack:///./src/App.vue?94c8","webpack:///./src/components/home.vue?88ca","webpack:///./src/utils/three/pulgins/MapControls.js","webpack:///./src/utils/three/GltfModel.js","webpack:///./src/utils/three/ObjectSelect.js","webpack:///./src/utils/three/Route.js","webpack:///./src/utils/three/RouteLine.js","webpack:///./src/utils/three/AGVCar.js","webpack:///./src/utils/three/personModel.js","webpack:///./src/utils/three/index.js","webpack:///src/components/home.vue","webpack:///./src/components/home.vue?48d5","webpack:///./src/components/home.vue","webpack:///src/App.vue","webpack:///./src/App.vue?60d0","webpack:///./src/App.vue","webpack:///./src/main.js","webpack:///./src/components/home.vue?a32f"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","staticRenderFns","ref","staticClass","on","reset","_v","_l","item","index","class","currentIndex","$event","chooseRoom","_s","MapControls","domElement","undefined","document","enabled","target","Vector3","minDistance","maxDistance","Infinity","minZoom","maxZoom","minPolarAngle","maxPolarAngle","Math","PI","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","enableZoom","zoomSpeed","enableRotate","rotateSpeed","enablePan","panSpeed","screenSpacePanning","keyPanSpeed","autoRotate","autoRotateSpeed","enableKeys","keys","LEFT","UP","RIGHT","BOTTOM","mouseButtons","MOUSE","MIDDLE","target0","clone","position0","position","zoom0","zoom","getPolarAngle","spherical","phi","getAzimuthalAngle","theta","saveState","scope","copy","updateProjectionMatrix","dispatchEvent","changeEvent","update","state","STATE","NONE","offset","quat","Quaternion","setFromUnitVectors","up","quatInverse","inverse","lastPosition","lastQuaternion","sub","applyQuaternion","setFromVector3","rotateLeft","getAutoRotationAngle","sphericalDelta","max","min","makeSafe","radius","scale","add","panOffset","setFromSpherical","lookAt","multiplyScalar","set","zoomChanged","distanceToSquared","EPS","dot","quaternion","dispose","removeEventListener","onContextMenu","onMouseDown","onMouseWheel","onTouchStart","onTouchEnd","onTouchMove","onMouseMove","onMouseUp","onKeyDown","type","startEvent","endEvent","ROTATE_UP","ROTATE_LEFT","ROTATE","DOLLY","DOLLY_ROTATE","PAN","DOLLY_PAN","Spherical","rotateStart","Vector2","rotateStart2","rotateEnd","rotateEnd2","rotateDelta","rotateDelta2","rotateDeltaStartFingers","rotateDeltaEndFingers","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","getZoomScale","pow","angle","rotateUp","panLeft","v","distance","objectMatrix","setFromMatrixColumn","panUp","crossVectors","pan","deltaX","deltaY","element","body","isPerspectiveCamera","targetDistance","tan","fov","clientHeight","matrix","isOrthographicCamera","right","left","clientWidth","top","bottom","console","warn","dollyIn","dollyScale","dollyOut","handleMouseDownRotate","event","clientX","clientY","handleMouseDownDolly","handleMouseDownPan","handleMouseMoveRotate","subVectors","x","y","handleMouseMoveDolly","handleMouseMovePan","handleMouseUp","handleMouseWheel","handleKeyDown","keyCode","handleTouchStartRotate","touches","pageX","pageY","handleTouchStartDolly","dx","dy","sqrt","handleTouchStartPan","handleTouchMoveRotate","isRotateUp","isHorizontal","isVertical","precision","sin","vector","abs","cos","handleTouchMoveDolly","handleTouchMovePan","handleTouchEnd","preventDefault","button","ctrlKey","metaKey","shiftKey","addEventListener","stopPropagation","EventDispatcher","constructor","defineProperties","center","noZoom","noRotate","noPan","noKeys","staticMoving","dynamicDampingFactor","GltfModel","APP","gltfLoader","GLTFLoader","gltfGroup","THREE","nameList","Promise","resolve","buildingModel","load","obj","sceneGLTF","scene","setCastShadow","setReceiveShadow","setCastSh","castShadow","material","side","shadowSide","children","map","child","setReceiveSh","receiveShadow","ObjectSelect","_scene","_camera","outlinePass","_orbitControl","fun","cameraPosition","controlTarget","personModels","downPoint","currObj","upPoint","raycaster","mouse","selectedObjects","moveSpeed","getMousePosition","setFromCamera","intersects","intersectObjects","point","log","changedTouches","innerWidth","innerHeight","onMouseup","parent","setTimeout","z","bool","workDate","walk","translateY","onDocumentMouseMove","pop","includes","visibleEdgeColor","parseInt","Route","option","curvePoints","Array","points","curve","RouteLine","getPoints","geometry","vertices","color","line","uuid","No","Name","AGVCar","curObj","callBack","mtlLoader","MTLLoader","mtl","objLoader","OBJLoader","object3D","traverse","applyMatrix","makeRotationY","transparent","setMaterials","fbxLoader","FBXLoader","PersonModel","camera","controls","world","arr","that","personModel","defaultMaterial","CANNON","gltfModel","gltf","_size","height","width","applyMatrix4","rotateY","updateMatrix","visible","animations","mixer","idleClip","runClip","walkClip","idleAction","clipAction","timeScale","runAction","walkAction","play","clock","setInterval","getDelta","destination","walkData","speed","originPos","cameraOriginPos","size","mass","shape","w","velocity","fixedRotation","updateMassProperties","cannon","normalize","speedVector","setLength","stop","addBody","refreshFrameId","requestAnimationFrame","h","bodies","find","watchFrameId","h1","walk_upStage","walk_downStage","timer","walk_over","collisionArr","originArr","forEach","origin","origin_t","filter","sort","item2","item1","avoidRepeat","sleep","x1","y1","z1","_vector","_height","upStage_timer","applyImpulse","distanceArr","downStage_timer","moveVector","clearTimeout","cancelAnimationFrame","removeBody","Store3D","initScene","initCamera","initRenderer","initOrbitControl","setCameraTarget","initWord","initStats","initAxisHelper","initBuilding","initPerson","initLight","initoutLine","initComposer","initObjectSelect","initAgvCar","initReSize","resetEyes","gravity","defalutContactMaterial","friction","restitution","addContactMaterial","no","initCameraSub","initSubStore","initSubGroup","initMain","animate","animateSub","cameraMotion","renderer","antialias","alpha","logarithmicDepthBuffer","shadowMap","setSize","setClearColor","setPixelRatio","devicePixelRatio","container","getElementById","appendChild","renderPass","RenderPass","composer","EffectComposer","addPass","OutlinePass","edgeStrength","edgeGlow","usePatternTexture","edgeThickness","downSampleRatio","pulsePeriod","hiddenEdgeColor","renderToScreen","orbitControl","PersonModels","personDefaultPosition","personDefaultTarget","ambient","addObject","directionalLight","onlyShadow","shadow","near","far","mapSize","stats","Stats","style","axes","objects","person","loadModel","then","res","buildings","buildingData","buildingObjects","objectOption","objectType","AgvCar","agvCar","LoadFBX","car","getObjectByName","nameorid","tmpObject","id","remove","tmpIsShow","objectLockPointer","removeObject","roomRateShow","showRoomRate","objectsRoomRate","storeIsShow","shelfIsShow","skyBox","goodTypes","spriteIsShow","lockcontrols","PointerLockControls","moveForward","moveLeft","moveBackward","moveRight","canJump","onKeyUp","changeSpriteShow","getObject","lock","isLocked","ray","intersections","onObject","time","performance","now","delta","prevTime","direction","Number","translateX","translateZ","display","aspect","render","TWEEN","dt","step","firstTime","groupIsShow","objName","tarx","tary","tarz","tween","Tween","x2","y2","z2","to","self","onUpdate","onComplete","easing","Easing","Exponential","InOut","start","list","room0cameraPosition","room0controlTarget","room1cameraPosition","room1controlTarget","room2cameraPosition","room2controlTarget","room3cameraPosition","room3controlTarget","room0Person","room1Person","room2Person","room3Person","created","mounted","methods","mapInit","component","components","home","Vue","config","productionTip","App","$mount"],"mappings":"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","file":"js/app.80fc29eb.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('home')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{ref:\"threeMapDialog\",attrs:{\"id\":\"container\"}}),_c('div',{staticClass:\"view\"},[_c('div',{on:{\"click\":_vm.reset}},[_vm._v(\"全局视角\")]),_vm._l((_vm.list),function(item,index){return _c('div',{key:index,class:index === _vm.currentIndex ? 'blue': '',on:{\"click\":function($event){return _vm.chooseRoom(index)}}},[_vm._v(_vm._s(item))])})],2)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/* eslint-disable */\n/**\n * @author qiao / https://github.com/qiao\n * @author mrdoob / http://mrdoob.com\n * @author alteredq / http://alteredqualia.com/\n * @author WestLangley / http://github.com/WestLangley\n * @author erich666 / http://erichaines.com\n * @author moroine / https://github.com/moroine\n */\n\nimport {\n\tEventDispatcher,\n\tMOUSE,\n\tQuaternion,\n\tSpherical,\n\tVector2,\n\tVector3\n} from \"three\";\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n// This is very similar to OrbitControls, another set of touch behavior\n//\n//    Orbit - right mouse, or left mouse + ctrl/meta/shiftKey / touch: two-finger rotate\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - left mouse, or arrow keys / touch: one-finger move\n\nvar MapControls = function ( object, domElement ) {\n\n\tthis.object = object;\n\n\tthis.domElement = ( domElement !== undefined ) ? domElement : document;\n\n\t// Set to false to disable this control\n\tthis.enabled = true;\n\n\t// \"target\" sets the location of focus, where the object orbits around\n\tthis.target = new Vector3();\n\n\t// How far you can dolly in and out ( PerspectiveCamera only )\n\tthis.minDistance = 0;\n\tthis.maxDistance = Infinity;\n\n\t// How far you can zoom in and out ( OrthographicCamera only )\n\tthis.minZoom = 0;\n\tthis.maxZoom = Infinity;\n\n\t// How far you can orbit vertically, upper and lower limits.\n\t// Range is 0 to Math.PI radians.\n\tthis.minPolarAngle = 0; // radians\n\tthis.maxPolarAngle = Math.PI; // radians\n\n\t// How far you can orbit horizontally, upper and lower limits.\n\t// If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\n\tthis.minAzimuthAngle = - Infinity; // radians\n\tthis.maxAzimuthAngle = Infinity; // radians\n\n\t// Set to true to enable damping (inertia)\n\t// If damping is enabled, you must call controls.update() in your animation loop\n\tthis.enableDamping = false;\n\tthis.dampingFactor = 0.25;\n\n\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n\t// Set to false to disable zooming\n\tthis.enableZoom = true;\n\tthis.zoomSpeed = 1.0;\n\n\t// Set to false to disable rotating\n\tthis.enableRotate = true;\n\tthis.rotateSpeed = 1.0;\n\n\t// Set to false to disable panning\n\tthis.enablePan = true;\n\tthis.panSpeed = 1.0;\n\tthis.screenSpacePanning = false; // if true, pan in screen-space\n\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\n\t// Set to true to automatically rotate around the target\n\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\n\tthis.autoRotate = false;\n\tthis.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\n\n\t// Set to false to disable use of the keys\n\tthis.enableKeys = true;\n\n\t// The four arrow keys\n\tthis.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\n\n\t// Mouse buttons\n\tthis.mouseButtons = { LEFT: MOUSE.LEFT, MIDDLE: MOUSE.MIDDLE, RIGHT: MOUSE.RIGHT };\n\n\t// for reset\n\tthis.target0 = this.target.clone();\n\tthis.position0 = this.object.position.clone();\n\tthis.zoom0 = this.object.zoom;\n\n\t//\n\t// public methods\n\t//\n\n\tthis.getPolarAngle = function () {\n\n\t\treturn spherical.phi;\n\n\t};\n\n\tthis.getAzimuthalAngle = function () {\n\n\t\treturn spherical.theta;\n\n\t};\n\n\tthis.saveState = function () {\n\n\t\tscope.target0.copy( scope.target );\n\t\tscope.position0.copy( scope.object.position );\n\t\tscope.zoom0 = scope.object.zoom;\n\n\t};\n\n\tthis.reset = function () {\n\n\t\tscope.target.copy( scope.target0 );\n\t\tscope.object.position.copy( scope.position0 );\n\t\tscope.object.zoom = scope.zoom0;\n\n\t\tscope.object.updateProjectionMatrix();\n\t\tscope.dispatchEvent( changeEvent );\n\n\t\tscope.update();\n\n\t\tstate = STATE.NONE;\n\n\t};\n\n\t// this method is exposed, but perhaps it would be better if we can make it private...\n\tthis.update = function () {\n\n\t\tvar offset = new Vector3();\n\n\t\t// so camera.up is the orbit axis\n\t\tvar quat = new Quaternion().setFromUnitVectors( object.up, new Vector3( 0, 1, 0 ) );\n\t\tvar quatInverse = quat.clone().inverse();\n\n\t\tvar lastPosition = new Vector3();\n\t\tvar lastQuaternion = new Quaternion();\n\n\t\treturn function update() {\n\n\t\t\tvar position = scope.object.position;\n\n\t\t\toffset.copy( position ).sub( scope.target );\n\n\t\t\t// rotate offset to \"y-axis-is-up\" space\n\t\t\toffset.applyQuaternion( quat );\n\n\t\t\t// angle from z-axis around y-axis\n\t\t\tspherical.setFromVector3( offset );\n\n\t\t\tif ( scope.autoRotate && state === STATE.NONE ) {\n\n\t\t\t\trotateLeft( getAutoRotationAngle() );\n\n\t\t\t}\n\n\t\t\tspherical.theta += sphericalDelta.theta;\n\t\t\tspherical.phi += sphericalDelta.phi;\n\n\t\t\t// restrict theta to be between desired limits\n\t\t\tspherical.theta = Math.max( scope.minAzimuthAngle, Math.min( scope.maxAzimuthAngle, spherical.theta ) );\n\n\t\t\t// restrict phi to be between desired limits\n\t\t\tspherical.phi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, spherical.phi ) );\n\n\t\t\tspherical.makeSafe();\n\n\n\t\t\tspherical.radius *= scale;\n\n\t\t\t// restrict radius to be between desired limits\n\t\t\tspherical.radius = Math.max( scope.minDistance, Math.min( scope.maxDistance, spherical.radius ) );\n\n\t\t\t// move target to panned location\n\t\t\tscope.target.add( panOffset );\n\n\t\t\toffset.setFromSpherical( spherical );\n\n\t\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\t\toffset.applyQuaternion( quatInverse );\n\n\t\t\tposition.copy( scope.target ).add( offset );\n\n\t\t\tscope.object.lookAt( scope.target );\n\n\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\tsphericalDelta.theta *= ( 1 - scope.dampingFactor );\n\t\t\t\tsphericalDelta.phi *= ( 1 - scope.dampingFactor );\n\n\t\t\t\tpanOffset.multiplyScalar( 1 - scope.dampingFactor );\n\n\t\t\t} else {\n\n\t\t\t\tsphericalDelta.set( 0, 0, 0 );\n\n\t\t\t\tpanOffset.set( 0, 0, 0 );\n\n\t\t\t}\n\n\t\t\tscale = 1;\n\n\t\t\t// update condition is:\n\t\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n\t\t\tif ( zoomChanged ||\n\t\t\t\tlastPosition.distanceToSquared( scope.object.position ) > EPS ||\n\t\t\t\t8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ) {\n\n\t\t\t\tscope.dispatchEvent( changeEvent );\n\n\t\t\t\tlastPosition.copy( scope.object.position );\n\t\t\t\tlastQuaternion.copy( scope.object.quaternion );\n\t\t\t\tzoomChanged = false;\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t\treturn false;\n\n\t\t};\n\n\t}();\n\n\tthis.dispose = function () {\n\n\t\tscope.domElement.removeEventListener( 'contextmenu', onContextMenu, false );\n\t\tscope.domElement.removeEventListener( 'mousedown', onMouseDown, false );\n\t\tscope.domElement.removeEventListener( 'wheel', onMouseWheel, false );\n\n\t\tscope.domElement.removeEventListener( 'touchstart', onTouchStart, false );\n\t\tscope.domElement.removeEventListener( 'touchend', onTouchEnd, false );\n\t\tscope.domElement.removeEventListener( 'touchmove', onTouchMove, false );\n\n\t\tdocument.removeEventListener( 'mousemove', onMouseMove, false );\n\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\n\n\t\twindow.removeEventListener( 'keydown', onKeyDown, false );\n\n\t\t//scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\n\n\t};\n\n\t//\n\t// internals\n\t//\n\n\tvar scope = this;\n\n\tvar changeEvent = { type: 'change' };\n\tvar startEvent = { type: 'start' };\n\tvar endEvent = { type: 'end' };\n\n\tvar STATE = {\n\t\tNONE: 0,\n\t\tROTATE_UP: 1,\n\t\tROTATE_LEFT: 2,\n\t\tROTATE: 3, // ROTATE_UP | ROTATE_LEFT\n\t\tDOLLY: 4,\n\t\tDOLLY_ROTATE: 7, // ROTATE | DOLLY\n\t\tPAN: 8,\n\t\tDOLLY_PAN: 12, // DOLLY | PAN\n\t};\n\n\tvar state = STATE.NONE;\n\n\tvar EPS = 0.000001;\n\n\t// current position in spherical coordinates\n\tvar spherical = new Spherical();\n\tvar sphericalDelta = new Spherical();\n\n\tvar scale = 1;\n\tvar panOffset = new Vector3();\n\tvar zoomChanged = false;\n\n\tvar rotateStart = new Vector2();\n\tvar rotateStart2 = new Vector2();\n\tvar rotateEnd = new Vector2();\n\tvar rotateEnd2 = new Vector2();\n\tvar rotateDelta = new Vector2();\n\tvar rotateDelta2 = new Vector2();\n\tvar rotateDeltaStartFingers = new Vector2();\n\tvar rotateDeltaEndFingers = new Vector2();\n\n\tvar panStart = new Vector2();\n\tvar panEnd = new Vector2();\n\tvar panDelta = new Vector2();\n\n\tvar dollyStart = new Vector2();\n\tvar dollyEnd = new Vector2();\n\tvar dollyDelta = new Vector2();\n\n\tfunction getAutoRotationAngle() {\n\n\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\n\t}\n\n\tfunction getZoomScale() {\n\n\t\treturn Math.pow( 0.95, scope.zoomSpeed );\n\n\t}\n\n\tfunction rotateLeft( angle ) {\n\n\t\tsphericalDelta.theta -= angle;\n\n\t}\n\n\tfunction rotateUp( angle ) {\n\n\t\tsphericalDelta.phi -= angle;\n\n\t}\n\n\tvar panLeft = function () {\n\n\t\tvar v = new Vector3();\n\n\t\treturn function panLeft( distance, objectMatrix ) {\n\n\t\t\tv.setFromMatrixColumn( objectMatrix, 0 ); // get X column of objectMatrix\n\t\t\tv.multiplyScalar( - distance );\n\n\t\t\tpanOffset.add( v );\n\n\t\t};\n\n\t}();\n\n\tvar panUp = function () {\n\n\t\tvar v = new Vector3();\n\n\t\treturn function panUp( distance, objectMatrix ) {\n\n\t\t\tif ( scope.screenSpacePanning === true ) {\n\n\t\t\t\tv.setFromMatrixColumn( objectMatrix, 1 );\n\n\t\t\t} else {\n\n\t\t\t\tv.setFromMatrixColumn( objectMatrix, 0 );\n\t\t\t\tv.crossVectors( scope.object.up, v );\n\n\t\t\t}\n\n\t\t\tv.multiplyScalar( distance );\n\n\t\t\tpanOffset.add( v );\n\n\t\t};\n\n\t}();\n\n\t// deltaX and deltaY are in pixels; right and down are positive\n\tvar pan = function () {\n\n\t\tvar offset = new Vector3();\n\n\t\treturn function pan( deltaX, deltaY ) {\n\n\t\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\t// perspective\n\t\t\t\tvar position = scope.object.position;\n\t\t\t\toffset.copy( position ).sub( scope.target );\n\t\t\t\tvar targetDistance = offset.length();\n\n\t\t\t\t// half of the fov is center to top of screen\n\t\t\t\ttargetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\n\n\t\t\t\t// we use only clientHeight here so aspect ratio does not distort speed\n\t\t\t\tpanLeft( 2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix );\n\t\t\t\tpanUp( 2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix );\n\n\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\t// orthographic\n\t\t\t\tpanLeft( deltaX * ( scope.object.right - scope.object.left ) / scope.object.zoom / element.clientWidth, scope.object.matrix );\n\t\t\t\tpanUp( deltaY * ( scope.object.top - scope.object.bottom ) / scope.object.zoom / element.clientHeight, scope.object.matrix );\n\n\t\t\t} else {\n\n\t\t\t\t// camera neither orthographic nor perspective\n\t\t\t\tconsole.warn( 'WARNING: MapControls.js encountered an unknown camera type - pan disabled.' );\n\t\t\t\tscope.enablePan = false;\n\n\t\t\t}\n\n\t\t};\n\n\t}();\n\n\tfunction dollyIn( dollyScale ) {\n\n\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\tscale /= dollyScale;\n\n\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom * dollyScale ) );\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tzoomChanged = true;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'WARNING: MapControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\tscope.enableZoom = false;\n\n\t\t}\n\n\t}\n\n\tfunction dollyOut( dollyScale ) {\n\n\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\tscale *= dollyScale;\n\n\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / dollyScale ) );\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tzoomChanged = true;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'WARNING: MapControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\tscope.enableZoom = false;\n\n\t\t}\n\n\t}\n\n\t//\n\t// event callbacks - update the object state\n\t//\n\n\tfunction handleMouseDownRotate( event ) {\n\n\t\t//console.log( 'handleMouseDownRotate' );\n\n\t\trotateStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseDownDolly( event ) {\n\n\t\t//console.log( 'handleMouseDownDolly' );\n\n\t\tdollyStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseDownPan( event ) {\n\n\t\t//console.log( 'handleMouseDownPan' );\n\n\t\tpanStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseMoveRotate( event ) {\n\n\t\t//console.log( 'handleMouseMoveRotate' );\n\n\t\trotateEnd.set( event.clientX, event.clientY );\n\n\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\trotateStart.copy( rotateEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseMoveDolly( event ) {\n\n\t\t//console.log( 'handleMouseMoveDolly' );\n\n\t\tdollyEnd.set( event.clientX, event.clientY );\n\n\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\n\t\tif ( dollyDelta.y > 0 ) {\n\n\t\t\tdollyIn( getZoomScale() );\n\n\t\t} else if ( dollyDelta.y < 0 ) {\n\n\t\t\tdollyOut( getZoomScale() );\n\n\t\t}\n\n\t\tdollyStart.copy( dollyEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseMovePan( event ) {\n\n\t\t//console.log( 'handleMouseMovePan' );\n\n\t\tpanEnd.set( event.clientX, event.clientY );\n\n\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\tpan( panDelta.x, panDelta.y );\n\n\t\tpanStart.copy( panEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseUp( event ) {\n\n\t\t// console.log( 'handleMouseUp' );\n\n\t}\n\n\tfunction handleMouseWheel( event ) {\n\n\t\t// console.log( 'handleMouseWheel' );\n\n\t\tif ( event.deltaY < 0 ) {\n\n\t\t\tdollyOut( getZoomScale() );\n\n\t\t} else if ( event.deltaY > 0 ) {\n\n\t\t\tdollyIn( getZoomScale() );\n\n\t\t}\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleKeyDown( event ) {\n\n\t\t//console.log( 'handleKeyDown' );\n\n\t\tswitch ( event.keyCode ) {\n\n\t\t\tcase scope.keys.UP:\n\t\t\t\tpan( 0, scope.keyPanSpeed );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.BOTTOM:\n\t\t\t\tpan( 0, - scope.keyPanSpeed );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.LEFT:\n\t\t\t\tpan( scope.keyPanSpeed, 0 );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.RIGHT:\n\t\t\t\tpan( - scope.keyPanSpeed, 0 );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tfunction handleTouchStartRotate( event ) {\n\n\t\t// console.log( 'handleTouchStartRotate' );\n\n\t\t// First finger\n\t\trotateStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t// Second finger\n\t\trotateStart2.set( event.touches[ 1 ].pageX, event.touches[ 1 ].pageY );\n\n\t}\n\n\tfunction handleTouchStartDolly( event ) {\n\n\t\tif ( scope.enableZoom ) {\n\n\t\t\t// console.log( 'handleTouchStartDolly' );\n\n\t\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\n\t\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\tdollyStart.set( 0, distance );\n\n\t\t}\n\n\t}\n\n\tfunction handleTouchStartPan( event ) {\n\n\t\tif ( scope.enablePan ) {\n\n\t\t\t// console.log( 'handleTouchStartPan' );\n\n\t\t\tpanStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t}\n\n\t}\n\n\tfunction handleTouchMoveRotate( event ) {\n\n\t\tif ( scope.enableRotate === false ) return;\n\t\tif ( ( state & STATE.ROTATE ) === 0 ) return;\n\n\t\t// First finger\n\t\trotateEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t// Second finger\n\t\trotateEnd2.set( event.touches[ 1 ].pageX, event.touches[ 1 ].pageY );\n\n\t\trotateDelta.subVectors( rotateEnd, rotateStart );\n\t\trotateDelta2.subVectors( rotateEnd2, rotateStart2 );\n\t\trotateDeltaStartFingers.subVectors( rotateStart2, rotateStart );\n\t\trotateDeltaEndFingers.subVectors( rotateEnd2, rotateEnd );\n\n\t\tif ( isRotateUp() ) {\n\n\t\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n\t\t\t// rotating up and down along whole screen attempts to go 360, but limited to 180\n\t\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\t\t// Start rotateUp ==> disable all movement to prevent flickering\n\t\t\tstate = STATE.ROTATE_UP;\n\n\t\t} else if ( ( state & STATE.ROTATE_LEFT ) !== 0 ) {\n\n\t\t\trotateLeft( ( rotateDeltaStartFingers.angle() - rotateDeltaEndFingers.angle() ) * scope.rotateSpeed );\n\n\t\t}\n\n\t\trotateStart.copy( rotateEnd );\n\t\trotateStart2.copy( rotateEnd2 );\n\n\t}\n\n\tfunction isRotateUp() {\n\n\t\t// At start, does the two fingers are aligned horizontally\n\t\tif ( ! isHorizontal( rotateDeltaStartFingers ) ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// At end, does the two fingers are aligned horizontally\n\t\tif ( ! isHorizontal( rotateDeltaEndFingers ) ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// does the first finger moved vertically between start and end\n\t\tif ( ! isVertical( rotateDelta ) ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// does the second finger moved vertically between start and end\n\t\tif ( ! isVertical( rotateDelta2 ) ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// Does the two finger moved in the same direction (prevent moving one finger vertically up while the other goes down)\n\t\treturn rotateDelta.dot( rotateDelta2 ) > 0;\n\n\t}\n\n\tvar isHorizontal = function () {\n\n\t\tvar precision = Math.sin( Math.PI / 6 );\n\n\t\treturn function isHorizontal( vector ) {\n\n\t\t\treturn Math.abs( Math.sin( vector.angle() ) ) < precision;\n\n\t\t};\n\n\t}();\n\n\tvar isVertical = function () {\n\n\t\tvar precision = Math.cos( Math.PI / 2 - Math.PI / 6 );\n\n\t\treturn function isVertical( vector ) {\n\n\t\t\treturn Math.abs( Math.cos( vector.angle() ) ) < precision;\n\n\t\t};\n\n\t}();\n\n\tfunction handleTouchMoveDolly( event ) {\n\n\t\tif ( scope.enableZoom === false ) return;\n\t\tif ( ( state & STATE.DOLLY ) === 0 ) return;\n\n\t\t// console.log( 'handleTouchMoveDolly' );\n\n\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\n\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\tdollyEnd.set( 0, distance );\n\n\t\tdollyDelta.set( 0, Math.pow( dollyEnd.y / dollyStart.y, scope.zoomSpeed ) );\n\n\t\tdollyIn( dollyDelta.y );\n\n\t\tdollyStart.copy( dollyEnd );\n\n\t}\n\n\tfunction handleTouchMovePan( event ) {\n\n\t\tif ( scope.enablePan === false ) return;\n\t\tif ( ( state & STATE.PAN ) === 0 ) return;\n\n\t\t// console.log( 'handleTouchMovePan' );\n\n\t\tpanEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\tpan( panDelta.x, panDelta.y );\n\n\t\tpanStart.copy( panEnd );\n\n\t}\n\n\tfunction handleTouchEnd( event ) {\n\n\t\t//console.log( 'handleTouchEnd' );\n\n\t}\n\n\t//\n\t// event handlers - FSM: listen for events and reset state\n\t//\n\n\tfunction onMouseDown( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t\tswitch ( event.button ) {\n\n\t\t\tcase scope.mouseButtons.LEFT:\n\n\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase scope.mouseButtons.MIDDLE:\n\n\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\thandleMouseDownDolly( event );\n\n\t\t\t\tstate = STATE.DOLLY;\n\n\t\t\t\tbreak;\n\n\t\t\tcase scope.mouseButtons.RIGHT:\n\n\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tif ( state !== STATE.NONE ) {\n\n\t\t\tdocument.addEventListener( 'mousemove', onMouseMove, false );\n\t\t\tdocument.addEventListener( 'mouseup', onMouseUp, false );\n\n\t\t\tscope.dispatchEvent( startEvent );\n\n\t\t}\n\n\t}\n\n\tfunction onMouseMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t\tswitch ( state ) {\n\n\t\t\tcase STATE.ROTATE:\n\n\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\thandleMouseMoveRotate( event );\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.DOLLY:\n\n\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\thandleMouseMoveDolly( event );\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.PAN:\n\n\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\thandleMouseMovePan( event );\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tfunction onMouseUp( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\thandleMouseUp( event );\n\n\t\tdocument.removeEventListener( 'mousemove', onMouseMove, false );\n\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tfunction onMouseWheel( event ) {\n\n\t\tif ( scope.enabled === false || scope.enableZoom === false || ( state !== STATE.NONE && state !== STATE.ROTATE ) ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tscope.dispatchEvent( startEvent );\n\n\t\thandleMouseWheel( event );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t}\n\n\tfunction onKeyDown( event ) {\n\n\t\tif ( scope.enabled === false || scope.enableKeys === false || scope.enablePan === false ) return;\n\n\t\thandleKeyDown( event );\n\n\t}\n\n\tfunction onTouchStart( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1:\t// one-fingered touch: pan\n\n\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\thandleTouchStartPan( event );\n\n\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\t// two-fingered touch: rotate-dolly\n\n\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\n\t\t\t\thandleTouchStartRotate( event );\n\t\t\t\thandleTouchStartDolly( event );\n\n\t\t\t\tstate = STATE.DOLLY_ROTATE;\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t\tif ( state !== STATE.NONE ) {\n\n\t\t\tscope.dispatchEvent( startEvent );\n\n\t\t}\n\n\t}\n\n\tfunction onTouchMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1: // one-fingered touch: pan\n\n\t\t\t\tif ( scope.enablePan === false ) return;\n\t\t\t\tif ( state !== STATE.PAN ) return; // is this needed?\n\n\t\t\t\thandleTouchMovePan( event );\n\n\t\t\t\tscope.update();\n\n\t\t\t\tbreak;\n\n\t\t\tcase 2: // two-fingered touch: rotate-dolly\n\n\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\t\t\t\tif ( ( state & STATE.DOLLY_ROTATE ) === 0 ) return; // is this needed?\n\n\t\t\t\thandleTouchMoveRotate( event );\n\t\t\t\thandleTouchMoveDolly( event );\n\n\t\t\t\tscope.update();\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t}\n\n\tfunction onTouchEnd( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\thandleTouchEnd( event );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tfunction onContextMenu( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t}\n\n\t//\n\n\tscope.domElement.addEventListener( 'contextmenu', onContextMenu, false );\n\n\tscope.domElement.addEventListener( 'mousedown', onMouseDown, false );\n\tscope.domElement.addEventListener( 'wheel', onMouseWheel, false );\n\n\tscope.domElement.addEventListener( 'touchstart', onTouchStart, false );\n\tscope.domElement.addEventListener( 'touchend', onTouchEnd, false );\n\tscope.domElement.addEventListener( 'touchmove', onTouchMove, false );\n\n\twindow.addEventListener( 'keydown', onKeyDown, false );\n\n\t// force an update at start\n\n\tthis.update();\n\n};\n\nMapControls.prototype = Object.create( EventDispatcher.prototype );\nMapControls.prototype.constructor = MapControls;\n\nObject.defineProperties( MapControls.prototype, {\n\n\tcenter: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .center has been renamed to .target' );\n\t\t\treturn this.target;\n\n\t\t}\n\n\t},\n\n\t// backward compatibility\n\n\tnoZoom: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .noZoom has been deprecated. Use .enableZoom instead.' );\n\t\t\treturn ! this.enableZoom;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .noZoom has been deprecated. Use .enableZoom instead.' );\n\t\t\tthis.enableZoom = ! value;\n\n\t\t}\n\n\t},\n\n\tnoRotate: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .noRotate has been deprecated. Use .enableRotate instead.' );\n\t\t\treturn ! this.enableRotate;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .noRotate has been deprecated. Use .enableRotate instead.' );\n\t\t\tthis.enableRotate = ! value;\n\n\t\t}\n\n\t},\n\n\tnoPan: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .noPan has been deprecated. Use .enablePan instead.' );\n\t\t\treturn ! this.enablePan;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .noPan has been deprecated. Use .enablePan instead.' );\n\t\t\tthis.enablePan = ! value;\n\n\t\t}\n\n\t},\n\n\tnoKeys: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .noKeys has been deprecated. Use .enableKeys instead.' );\n\t\t\treturn ! this.enableKeys;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .noKeys has been deprecated. Use .enableKeys instead.' );\n\t\t\tthis.enableKeys = ! value;\n\n\t\t}\n\n\t},\n\n\tstaticMoving: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .staticMoving has been deprecated. Use .enableDamping instead.' );\n\t\t\treturn ! this.enableDamping;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .staticMoving has been deprecated. Use .enableDamping instead.' );\n\t\t\tthis.enableDamping = ! value;\n\n\t\t}\n\n\t},\n\n\tdynamicDampingFactor: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.' );\n\t\t\treturn this.dampingFactor;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.MapControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.' );\n\t\t\tthis.dampingFactor = value;\n\n\t\t}\n\n\t}\n\n} );\n\nexport { MapControls };\n","import * as THREE from 'three'\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader'\nclass GltfModel {\n  constructor(APP) {\n    this.APP = APP\n    this.gltfLoader = new GLTFLoader()\n    this.gltfGroup = new THREE.Group() // GLTF精模组\n    this.gltfGroup.name = 'glbGroup'\n    this.nameList = []\n    this.position = {}\n  }\n\n  /**\n   *  暴露出去的方法\n   *  加载精模\n   *  移动位置到相应地点\n   *  递归设置模型属性\n   */\n  loadModel () {\n    return new Promise((resolve) => {\n      // let buildingModel = '/3DModels/test2(1).glb'\n      let buildingModel = '/3DModels/metaland6.gltf'\n      this.gltfLoader.load(buildingModel, (obj) => {\n        const sceneGLTF = obj.scene\n        this.setCastShadow(sceneGLTF) // 设置可以产生投影\n        this.setReceiveShadow(sceneGLTF) // 设置可以接受投影\n        resolve(sceneGLTF)\n      })\n    })\n  }\n  // ===================== 阴影相关 =====================\n  /**\n   * 设置允许引起阴影\n   */\n  setCastShadow (object) {\n    const setCastSh = (obj) => {\n      // 允许产生阴影\n      obj.castShadow = true\n      // 递归往下设置\n      // 防止因接受阴影而导致的物体产生水波纹\n      if (obj.material) {\n        obj.material.side = THREE.DoubleSide\n        obj.material.shadowSide = THREE.BackSide\n      }\n      if (obj.children.length > 0) {\n        obj.children.map(child => {\n          setCastSh(child)\n        })\n      }\n    }\n    setCastSh(object)\n  }\n\n  /**\n   * 设置允许接受阴影\n   */\n  setReceiveShadow (object) {\n    const setReceiveSh = (obj) => {\n      // 对于mesh允许接受阴影（Object3D和Group不需要）\n      obj.receiveShadow = true\n      // 防止因接受阴影而导致的物体产生水波纹\n      if (obj.material) {\n        obj.material.side = THREE.DoubleSide\n        obj.material.shadowSide = THREE.BackSide\n      }\n      // 递归往下设置\n      if (obj.children.length > 0) {\n        obj.children.map(child => {\n          setReceiveSh(child)\n        })\n      }\n    }\n    setReceiveSh(object)\n  }\n}\n\nexport default GltfModel\n","import * as THREE from 'three'\r\n// eslint-disable-next-line no-unused-vars\r\nimport TWEEN from '@tweenjs/tween.js'\r\nexport const ObjectSelect = (_scene, _camera, outlinePass, _orbitControl, fun, cameraPosition, controlTarget, personModels) => {\r\n    var raycaster = new THREE.Raycaster();\r\n    var mouse = new THREE.Vector2();\r\n    var selectedObjects = [];\r\n    let downPoint\r\n    let currObj\r\n    let moveSpeed = 100\r\n    // eslint-disable-next-line no-unused-vars\r\n    let movingTarget\r\n    // eslint-disable-next-line no-unused-vars\r\n    let moveTime\r\n    let upPoint\r\n    /****************************************************************************************************************************\r\n     * 外包围处理*\r\n     * @type {THREE.OutlinePass}\r\n     */\r\n\r\n    // window.addEventListener('click', onMouseClick);\r\n    window.addEventListener('mousedown', onMouseDown)\r\n    // window.addEventListener('dblclick', onMouseDbClick);\r\n    window.addEventListener('mousemove', onDocumentMouseMove)\r\n    window.addEventListener('mouseup', onMouseup)\r\n    // eslint-disable-next-line no-unused-vars\r\n    function onMouseClick (event) {\r\n        getMousePosition(event)\r\n        raycaster.setFromCamera(mouse, _camera);\r\n        var intersects = raycaster.intersectObjects([_scene], true);\r\n\r\n        if (intersects.length == 0) {\r\n            return;\r\n        }\r\n        let coordinate\r\n        if (intersects[0] && intersects[0].point) {\r\n            coordinate = intersects[0].point\r\n            console.log(coordinate, '当前位置')\r\n        }\r\n    }\r\n    function onMouseDown (event) {\r\n        getMousePosition(event)\r\n        raycaster.setFromCamera(mouse, _camera)\r\n        var intersects = raycaster.intersectObjects([_scene], true);\r\n        if (intersects.length == 0) {\r\n            return;\r\n        }\r\n        if (intersects.length > 0) {\r\n            downPoint = intersects[0].point || new THREE.Vector3(0, 0, 0)\r\n        }\r\n        console.log(intersects[0].object.position, '当前点击位置')\r\n    }\r\n    function getMousePosition (event) {\r\n        let x, y;\r\n        if (event.changedTouches) {\r\n            x = event.changedTouches[0].pageX;\r\n            y = event.changedTouches[0].pageY;\r\n        } else {\r\n            x = event.clientX;\r\n            y = event.clientY;\r\n        }\r\n        mouse.x = (x / window.innerWidth) * 2 - 1\r\n        mouse.y = -(y / window.innerHeight) * 2 + 1\r\n    }\r\n    function onMouseup (event) {\r\n        getMousePosition(event)\r\n        raycaster.setFromCamera(mouse, _camera);\r\n        var intersects = raycaster.intersectObjects([_scene], true);\r\n\r\n        if (intersects.length == 0) {\r\n            return;\r\n        }\r\n        // let coordinate\r\n        // if (intersects[0] && intersects[0].point) {\r\n        //     coordinate = intersects[0].point\r\n        //     console.log(coordinate, '当前位置')\r\n        //     fun(coordinate.x, coordinate.y, coordinate.z, controlTarget[0], controlTarget[1], controlTarget[2])\r\n        // }\r\n        if (intersects.length > 0) {\r\n            currObj = intersects[0].object\r\n            upPoint = intersects[0].point || new THREE.Vector3(0, 0, 0)\r\n            // if (currObj.name = '') {\r\n\r\n            // }\r\n            if (currObj.name === \"paizi\" || currObj.parent.name === \"paizi\") {\r\n                fun(39.754684253046435, 0, -220.88455103281677, 39.754684253046435, 0, -220.88455103281677)\r\n                setTimeout(() => {\r\n                    _camera.lookAt(personModels.position.x, personModels.position.y, personModels.position.z);\r\n                }, 2000);\r\n                // fun(defaultLookArt[0], defaultLookArt[1], defaultLookArt[2], defaultLookArt[3], defaultLookArt[4], defaultLookArt[5])\r\n                // let defaultPosition = personModels.position\r\n                // _camera.position.x = defaultPosition.x\r\n                // _camera.position.y = defaultPosition.y\r\n                // _camera.position.z = defaultPosition.z\r\n                console.log(_camera, _orbitControl, '当前点击位置')\r\n\r\n            }\r\n            let bool = (upPoint.x == downPoint.x && upPoint.y == downPoint.y && upPoint.z == downPoint.z) && (currObj.name === 'bridge' || currObj.parent.name === 'bridge' || currObj.name === \"road_A\" || currObj.parent.name === \"road_A\")\r\n            if (bool) {\r\n                let distance = Math.sqrt(Math.pow(Math.abs(_camera.position.x - intersects[0].point.x), 2) + Math.pow(Math.abs(_camera.position.z - intersects[0].point.z), 2))\r\n                if (distance > moveSpeed) {\r\n                    let i = distance / moveSpeed\r\n                    moveTime = i * 1000\r\n                } else {\r\n                    moveTime = 1000\r\n\r\n                }\r\n                // movingTarget = new TWEEN.Tween(_camera.position)\r\n                let workDate = new THREE.Vector3(intersects[0].point.x, intersects[0].point.y + 88, intersects[0].point.z)\r\n                // movingTarget.to(workDate, moveTime)\r\n                personModels.walk(workDate);\r\n                _camera.translateY(10);\r\n                console.log(_camera, '相机位置')\r\n                // movingTarget.start()\r\n            }\r\n        }\r\n    }\r\n    // eslint-disable-next-line no-unused-vars\r\n    function onMouseDbClick (event) {\r\n        var x, y;\r\n        x = event.clientX;\r\n        y = event.clientY;\r\n        mouse.x = (x / window.innerWidth) * 2 - 1;\r\n        mouse.y = -(y / window.innerHeight) * 2 + 1;\r\n        raycaster.setFromCamera(mouse, _camera);\r\n        var intersects = raycaster.intersectObjects([_scene], true);\r\n        if (intersects.length == 0) {\r\n            hideOtherFloor(true); // 点了空地\r\n        } else { // 点了楼房\r\n            hideOtherFloor(false, intersects[0].object.parent.name)\r\n        }\r\n    }\r\n    function onDocumentMouseMove (event) {\r\n        console.log(_camera.position, '相机位置')\r\n        console.log(_orbitControl.target, '控制器的朝向')\r\n        var x, y;\r\n        if (event.changedTouches) {\r\n            x = event.changedTouches[0].pageX;\r\n            y = event.changedTouches[0].pageY;\r\n        } else {\r\n            x = event.clientX;\r\n            y = event.clientY;\r\n        }\r\n        mouse.x = (x / window.innerWidth) * 2 - 1;\r\n        mouse.y = -(y / window.innerHeight) * 2 + 1;\r\n        raycaster.setFromCamera(mouse, _camera);\r\n        var intersects = raycaster.intersectObjects([_scene], true);\r\n\r\n        if (intersects.length == 0) {\r\n            return;\r\n        }\r\n        if (intersects[0].object.name == \"\") {\r\n            // selectedObjects.pop();\r\n        } else {\r\n            selectedObjects.pop();\r\n            selectedObjects.push(intersects[0].object.parent);\r\n            outlinePass.selectedObjects = selectedObjects;//给选中的线条和物体加发光特效\r\n            let name = intersects[0].object.parent.parent.name\r\n            if (name.includes('smcyy_jmkl_f16_')) { // 第十六层\r\n                outlinePass.visibleEdgeColor.set('#e75f58') // 呼吸显示的颜色\r\n            } else {\r\n                outlinePass.visibleEdgeColor.set(parseInt('0x00FFFF')) // 呼吸显示的颜色\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    // false：双击某一层时，隐藏其他层    true：双击地面时，显示其他层\r\n    function hideOtherFloor (show, name) {\r\n        const building = _scene.getObjectByName(\r\n            \"smcyy_jmkl\"\r\n        ); // 这栋楼的实例\r\n        if (show) { // 展示所有楼房\r\n            // 显示其他层，恢复整栋楼\r\n            // 1.控制楼层显示\r\n            const floorList = building.children; // 这栋楼的所有层数组\r\n            _scene.getObjectByName(\"AGV小车\").visible = false\r\n            floorList.map((el) => {\r\n                el.visible = true;\r\n            })\r\n            fun(cameraPosition[0], cameraPosition[1], cameraPosition[2], controlTarget[0], controlTarget[1], controlTarget[2])\r\n        } else {\r\n            // 1.控制楼层隐藏\r\n            const floorList = building.children; // 这栋楼的所有层数组\r\n            if (name.includes('smcyy_jmkl_f16_')) { // 第十六层\r\n                _scene.getObjectByName(\"AGV小车\").visible = true\r\n            } else {\r\n                _scene.getObjectByName(\"AGV小车\").visible = false\r\n            }\r\n            floorList.map((el) => {\r\n                if (el.name !== name) {\r\n                    el.visible = false;\r\n                }\r\n            });\r\n            if (name === '9c001' || name === '8c001' || name === '7c001' || name === '6c001') {\r\n                fun(76.90097560862407, 2001.4524009301272, -198.43114513307248, 76.89897485376429, 1.45240093113044, -198.4311454917692)\r\n            } else if (name === '11c001' || name === '10c001') {\r\n                fun(76.90097560862407, 2001.4524009301272, -198.43114513307248, 76.89897485376429, 1.45240093113044, -198.4311454917692)\r\n            } else {\r\n                fun(76.90097560862407, 2001.4524009301272, -198.43114513307248, 76.89897485376429, 1.45240093113044, -198.4311454917692)\r\n            }\r\n            console.log(_camera, '相机数据')\r\n            console.log(_orbitControl, '控制器的数据')\r\n        }\r\n    }\r\n}","import * as THREE from 'three'\r\nexport const Route = (option) => {\r\n\r\n    let curvePoints = new Array();\r\n    for (let i = 0; i < option.points.length; i++) {\r\n        let point = option.points[i];\r\n        curvePoints.push(new THREE.Vector3(point.x, point.y, point.z));\r\n    }\r\n    let curve = new THREE.CatmullRomCurve3(curvePoints, false/*是否闭合*/, 'catmullrom', 0.000000001);\r\n    return curve;\r\n\r\n\r\n}","import * as THREE from 'three'\r\nexport const RouteLine = (curve, option) => {\r\n    let points = curve.getPoints(100);\r\n    let geometry = new THREE.BoxBufferGeometry();\r\n    //geometry.vertices = curve.getSpacedPoints(100);\r\n    // 把从曲线轨迹上获得的顶点坐标赋值给几何体\r\n    geometry.vertices = points;\r\n    var material = new THREE.LineBasicMaterial({\r\n        color: 0x4488ff\r\n    });\r\n    let line = new THREE.Line(geometry, material);\r\n    line.uuid = option.No;\r\n    line.name = option.Name;\r\n    line.type = \"Route\";\r\n    return line;\r\n}","import * as THREE from 'three'\r\nimport { MTLLoader } from 'three/examples/jsm/loaders/MTLLoader' // 模型导入\r\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader' // 模型导入\r\nimport { FBXLoader } from 'three/examples/jsm/loaders/FBXLoader.js'\r\nclass AGVCar {\r\n    constructor(option) {\r\n        option = option || { scale: 0.1 };\r\n        this.scale = option.scale;\r\n    }\r\n    Load = function (curObj, callBack) {\r\n        let mtlLoader = new MTLLoader();//mtl材质加载器\r\n        mtlLoader.load('/3DModels/CartoonMan008.mtl', mtl);//加载.mtl文件，执行mtl函数\r\n        function mtl (material) {\r\n            var objLoader = new OBJLoader();//obj模型加载器\r\n            objLoader.setMaterials(material);//mtl材质赋值给obj模型\r\n            objLoader.load('/3DModels/CartoonMan008.obj', obj);//加载.obj文件，执行obj函数 }\r\n            function obj (object3D) {\r\n                object3D.scale.set(1, 1, 1);//放大object3D对象\r\n                object3D.traverse(function (child) {\r\n                    if (child instanceof THREE.Mesh) {\r\n                        child.geometry.applyMatrix(new THREE.Matrix4().makeRotationY(Math.PI / 2));\r\n                        child.material.transparent = true;\r\n                    }\r\n                });\r\n                curObj[callBack](object3D);\r\n            }\r\n        }\r\n    }\r\n    LoadFBX = function (curObj, callBack) {\r\n        let fbxLoader = new FBXLoader();//mtl材质加载器\r\n        fbxLoader.load('/3DModels/Standard Idle.fbx', mtl);//加载.mtl文件，执行mtl函数\r\n        function mtl (material) {\r\n            material.scale.set(0.2, 0.2, 0.2);//放大object3D对象\r\n            material.traverse(function (child) {\r\n                if (child instanceof THREE.Mesh) {\r\n                    child.geometry.applyMatrix(new THREE.Matrix4().makeRotationY(Math.PI / 2));\r\n                    child.material.transparent = true;\r\n                }\r\n            });\r\n            curObj[callBack](material);\r\n        }\r\n    }\r\n}\r\nexport default AGVCar\r\n","import * as THREE from 'three'\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader'\nimport * as CANNON from 'cannon-es'\nclass PersonModel {\n  constructor(scene, camera, controls, world, arr) {\n    this.arr = arr\n    this.scene = scene\n    this.camera = camera\n    this.world = world\n    this.controls = controls\n    this.gltfLoader = new GLTFLoader()\n    this.gltfGroup = new THREE.Group() // GLTF精模组\n    this.gltfGroup.name = 'glbGroup'\n  }\n\n  /**\n   *  暴露出去的方法\n   *  加载精模\n   *  移动位置到相应地点\n   *  递归设置模型属性\n   */\n  // ===================== 阴影相关 =====================\n  /**\n   * 设置允许引起阴影\n   */\n  setCastShadow (object) {\n    const setCastSh = (obj) => {\n      // 允许产生阴影\n      obj.castShadow = true\n      // 递归往下设置\n      // 防止因接受阴影而导致的物体产生水波纹\n      if (obj.material) {\n        obj.material.side = THREE.DoubleSide\n        obj.material.shadowSide = THREE.BackSide\n      }\n      if (obj.children.length > 0) {\n        obj.children.map(child => {\n          setCastSh(child)\n        })\n      }\n    }\n    setCastSh(object)\n  }\n\n  /**\n   * 设置允许接受阴影\n   */\n  setReceiveShadow (object) {\n    const setReceiveSh = (obj) => {\n      // 对于mesh允许接受阴影（Object3D和Group不需要）\n      obj.receiveShadow = true\n      // 防止因接受阴影而导致的物体产生水波纹\n      if (obj.material) {\n        obj.material.side = THREE.DoubleSide\n        obj.material.shadowSide = THREE.BackSide\n      }\n      // 递归往下设置\n      if (obj.children.length > 0) {\n        obj.children.map(child => {\n          setReceiveSh(child)\n        })\n      }\n    }\n    setReceiveSh(object)\n  }\n  loadModel () {\n    return new Promise((resolve) => {\n      let that = this\n      let personModel = '/3DModels/Soldier.glb'\n      let defaultMaterial = new CANNON.Material(\"default\");\n      let gltfModel = null //人物模型\n      that.gltfLoader.load(personModel, (gltf) => {\n        gltfModel = gltf.scene;\n        gltfModel.children[0].scale.set(1, 1, 1); // 修正缩放\n        gltfModel._size = { length: 100, height: 182, width: 20 };\n\n        // 修正姿态\n        gltfModel.children[0].position.add(new THREE.Vector3(0, -gltfModel._size.height / 2, 0));\n        gltfModel.children[0].applyMatrix4(new THREE.Matrix4().makeRotationY((Math.PI / 180) * -180));\n        gltfModel.position.add(new THREE.Vector3(0, gltfModel._size.height / 2 + 200, 0));\n        gltfModel.rotateY((Math.PI / 180) * 90);\n        gltfModel.updateMatrix();\n        gltfModel.name = 'person'\n        gltfModel.position.set(0, -300, 0)\n        gltfModel.visible = true\n        this.setCastShadow(gltfModel)\n        this.setReceiveShadow(gltfModel)\n        that.scene.add(gltfModel); // 加入场景\n\n        // 动画处理\n        const animations = gltf.animations;\n        let mixer = new THREE.AnimationMixer(gltfModel);\n        const idleClip = animations[0];\n        const runClip = animations[1];\n        const walkClip = animations[3]; // 散步帧\n        gltfModel.idleAction = mixer.clipAction(idleClip); // 空闲\n        gltfModel.idleAction.timeScale = 2; // 2倍速播放\n        gltfModel.runAction = mixer.clipAction(runClip); // 跑步\n        gltfModel.walkAction = mixer.clipAction(walkClip); // 散步\n        gltfModel.walkAction.timeScale = 2; // 3倍速播放\n        gltfModel.idleAction.play(); // 开启空闲\n\n        // 更新混合器\n        var clock = new THREE.Clock();\n        setInterval(() => {\n          mixer.update(clock.getDelta());\n        }, 50);\n\n        // 模型移动\n        gltfModel.walk = function (destination) {\n          gltfModel.walkData = {\n            speed: 350, // 速度\n            originPos: gltfModel.position.clone(), // 老位置\n            cameraOriginPos: that.camera.position.clone(), // 老位置\n            destination, // 目标位置\n            vector: new THREE.Vector3(destination.x - gltfModel.position.x, 0, destination.z - gltfModel.position.z), // 移动向量\n            distance: new THREE.Vector3(destination.x - gltfModel.position.x, 0, destination.z - gltfModel.position.z).length(), // 距离\n            state: \"walk\", // 状态，walk，upStage上台阶，downState下台阶\n          };\n          // cannonjs模拟gltfModel对象\n          const position = gltfModel.position.clone();\n          const quaternion = gltfModel.quaternion;\n          const size = gltfModel._size;\n          var body = new CANNON.Body({\n            mass: 1, // 质量\n            position: new CANNON.Vec3(position.x, position.y, position.z), // 位置\n            shape: new CANNON.Box(new CANNON.Vec3(size.length / 2, size.height / 2, size.width / 2)), // 形状\n            quaternion: new CANNON.Quaternion(quaternion.x, quaternion.y, quaternion.z, quaternion.w),\n            material: defaultMaterial, // 添加材料\n            velocity: new CANNON.Vec3(0, 0, 0),\n          });\n          body.name = \"gltf\";\n          body.fixedRotation = true; // 旋转约束\n          body.updateMassProperties(); // 旋转约束\n          gltfModel.walkData.cannon = body;\n\n          const { speed, originPos, cameraOriginPos, vector, distance } = gltfModel.walkData; // 提取数据\n\n          // 修正方向\n          !(function () {\n            const quaternion = new THREE.Quaternion().setFromUnitVectors(new THREE.Vector3(0, 0, 1), vector.clone().normalize());\n            gltfModel.quaternion.copy(quaternion);\n            gltfModel.updateMatrix();\n            body.quaternion.set(quaternion.x, quaternion.y, quaternion.z, quaternion.w);\n          })();\n\n          // 位置矫正\n          body.position.set(originPos.x, originPos.y, originPos.z);\n\n          // 速度\n          const speedVector = vector.clone().normalize().setLength(speed);\n          body.velocity = new CANNON.Vec3(speedVector.x, speedVector.y, speedVector.z);\n\n          // 切换动画\n          gltfModel.walkAction.play();\n          gltfModel.idleAction.stop();\n\n          // 添加\n          that.world.addBody(body);\n\n          // 更新gltf模型\n          gltfModel.walkData.refreshFrameId = requestAnimationFrame(function h () {\n            if (!gltfModel.walkData) return;\n            gltfModel.walkData.refreshFrameId = requestAnimationFrame(h);\n            if (that.world.bodies.find((item) => item.name == \"gltf\")) {\n              const position = body.position; // 位置\n              const quaternion = body.quaternion; // 旋转和缩放四元数\n              gltfModel.position.set(position.x, position.y, position.z);\n              gltfModel.quaternion.set(quaternion.x, quaternion.y, quaternion.z, quaternion.w);\n              that.camera.position.copy(cameraOriginPos.clone().add(gltfModel.position.clone().sub(originPos.clone())));\n              that.controls.target.copy(gltfModel.position); // 控制器更新\n            }\n          });\n\n          // 上下台阶\n          gltfModel.walkData.watchFrameId = requestAnimationFrame(function h1 () {\n            if (!gltfModel.walkData) return;\n            gltfModel.walkData.watchFrameId = requestAnimationFrame(h1);\n            // 上台阶\n            gltfModel.walk_upStage();\n\n            // 下台阶\n            gltfModel.walk_downStage();\n          });\n\n          // 清定时器\n          gltfModel.walkData.timer = setTimeout(() => {\n            gltfModel.walk_over(destination, cameraOriginPos, vector);\n          }, (distance / speed) * 1000);\n        };\n\n        // 上台阶\n        gltfModel.walk_upStage = function () {\n          const { state, cannon: body, vector, speed } = gltfModel.walkData;\n          const speedVector = vector.clone().normalize().setLength(speed);\n          if (state !== \"walk\") return;\n\n          // 碰撞检测，采样200+个点\n          let collisionArr = []; // 碰撞对象数组\n          const originArr = []; // 点数组\n          const { length, height, width } = gltfModel._size;\n          originArr.push(...new THREE.LineCurve3(new THREE.Vector3(-length / 2, height / 2, width / 2), new THREE.Vector3(length / 2, height / 2, width / 2)).getPoints(50));\n          originArr.push(...new THREE.LineCurve3(new THREE.Vector3(length / 2, height / 2, width / 2), new THREE.Vector3(length / 2, -height / 2, width / 2)).getPoints(50));\n          originArr.push(...new THREE.LineCurve3(new THREE.Vector3(length / 2, -height / 2, width / 2), new THREE.Vector3(-length / 2, -height / 2, width / 2)).getPoints(50));\n          originArr.push(...new THREE.LineCurve3(new THREE.Vector3(-length / 2, -height / 2, width / 2), new THREE.Vector3(-length / 2, height / 2, width / 2)).getPoints(50));\n          originArr.forEach((origin) => {\n            const origin_t = origin.applyMatrix4(gltfModel.matrix).add(vector.clone().normalize().multiplyScalar(-2)).add(new THREE.Vector3(0, 2, 0));\n            let raycaster = new THREE.Raycaster(origin_t, vector.clone().normalize(), 0.1, 100000);\n            let intersects = raycaster.intersectObjects(that.arr);\n            intersects[0] && collisionArr.push(intersects[0]);\n          });\n\n          // 最小距离\n          collisionArr = collisionArr\n            .map((item) => {\n              item.distance -= 2;\n              return item;\n            })\n            .filter((item) => {\n              return item.distance >= 0;\n            })\n            .sort((item2, item1) => {\n              if (item1.distance <= item2.distance) return 1;\n              if (item1.distance > item2.distance) return -1;\n            });\n          if (!collisionArr.length) return;\n\n          if (collisionArr[0].distance < 10) {\n            gltfModel.walkData.state = \"upStage\";\n            2 ** 1123; // 碰撞过滤\n            body.avoidRepeat = true;\n            body.sleep(); // 立即睡眠\n            // 修正速度和位置\n            const { x, y, z } = speedVector;\n            body.velocity = new CANNON.Vec3(x, y, z);\n\n            // 上台阶\n            const { x: x1, y: y1, z: z1 } = gltfModel.position;\n            const _vector = vector\n              .clone()\n              .normalize()\n              .multiplyScalar(collisionArr[0].distance + 1);\n            const position = [x1 + _vector.x, y1 + collisionArr[0].object._height, z1 + _vector.z]; // 高度上到台阶上面，然后位置稍微往前挪1个单位的距离\n            body.position.set(...position);\n            gltfModel.position.set(...position);\n\n            // 结束\n            gltfModel.walkData.upStage_timer = setTimeout(() => {\n              if (!gltfModel.walkData) return;\n              // 唤醒睡眠\n              body.applyImpulse(new CANNON.Vec3(0.0001, 0.0001, 0.0001));\n              -1; // 碰撞过滤恢复\n              body.avoidRepeat = false; // 防重复字段，重置\n              gltfModel.walkData.state = \"walk\";\n            }, 50);\n          }\n        };\n\n        // 下台阶\n        gltfModel.walk_downStage = function () {\n          const { state, cannon: body, vector, speed } = gltfModel.walkData;\n          const speedVector = vector.clone().normalize().setLength(speed);\n          if (state !== \"walk\") return;\n\n          // 碰撞检测，采样200+个点\n          const distanceArr = []; // 距离数组\n          const originArr = []; // 点数组\n          const { length, height, width } = gltfModel._size;\n          originArr.push(...new THREE.LineCurve3(new THREE.Vector3(-length / 2, -height / 2, -width / 2), new THREE.Vector3(length / 2, -height / 2, -width / 2)).getPoints(50));\n          originArr.push(...new THREE.LineCurve3(new THREE.Vector3(length / 2, -height / 2, -width / 2), new THREE.Vector3(length / 2, -height / 2, width / 2)).getPoints(50));\n          originArr.push(...new THREE.LineCurve3(new THREE.Vector3(length / 2, -height / 2, width / 2), new THREE.Vector3(-length / 2, -height / 2, width / 2)).getPoints(50));\n          originArr.push(...new THREE.LineCurve3(new THREE.Vector3(-length / 2, -height / 2, width / 2), new THREE.Vector3(-length / 2, -height / 2, -width / 2)).getPoints(50));\n          originArr.forEach((origin) => {\n            const origin_t = origin.applyMatrix4(gltfModel.matrix).add(new THREE.Vector3(0, 2, 0));\n            let raycaster = new THREE.Raycaster(origin_t, new THREE.Vector3(0, -1, 0), 0.1, 100000);\n            let intersects = raycaster.intersectObjects(that.arr);\n            distanceArr.push(intersects[0]?.distance || 0);\n          });\n\n          // 最小距离\n          const minDistance = Math.min(...distanceArr) - 2;\n          if (minDistance > 5) {\n            gltfModel.walkData.state = \"downStage\";\n            2 ** 1123; // 碰撞过滤\n            body.avoidRepeat = true;\n            body.sleep(); // 立即睡眠\n\n            // 修正速度和位置\n            const { x, y, z } = speedVector;\n            body.velocity = new CANNON.Vec3(x, y, z);\n\n            // 下台阶\n            const { x: x1, y: y1, z: z1 } = gltfModel.position;\n            const _vector = vector.clone().normalize();\n            const position = [x1 + _vector.x, y1 - minDistance, z1 + _vector.z];\n            body.position.set(...position);\n            gltfModel.position.set(...position);\n\n            // 结束\n            gltfModel.walkData.downStage_timer = setTimeout(() => {\n              if (!gltfModel.walkData) return;\n              // 唤醒睡眠\n              body.applyImpulse(new CANNON.Vec3(0.0001, 0.0001, 0.0001));\n              -1; // 碰撞过滤恢复\n              body.avoidRepeat = false; // 防重复字段，重置\n              gltfModel.walkData.state = \"walk\";\n            }, 50);\n          }\n        };\n\n        // 结束移动\n        gltfModel.walk_over = function (destination, cameraOriginPos, moveVector) {\n          gltfModel.position.set(destination.x, destination.y, destination.z);\n          that.camera.position.copy(cameraOriginPos.clone().add(moveVector));\n          that.controls.target.copy(destination);\n          gltfModel.idleAction.play();\n          gltfModel.walkAction.stop();\n\n          // 清理定时器\n          gltfModel.walkData?.timer && clearTimeout(gltfModel.walkData.timer);\n          gltfModel.walkData.downStage_timer && clearTimeout(gltfModel.walkData.downStage_timer);\n          gltfModel.walkData.upStage_timer && clearTimeout(gltfModel.walkData.upStage_timer);\n          gltfModel.walkData.refreshFrameId && cancelAnimationFrame(gltfModel.walkData.refreshFrameId);\n          gltfModel.walkData.watchFrameId && cancelAnimationFrame(gltfModel.walkData.watchFrameId);\n\n          // 移除数据\n          gltfModel.walkData?.cannon && that.world.removeBody(gltfModel.walkData.cannon);\n          gltfModel.walkData = null;\n        };\n        resolve(gltfModel)\n      })\n    })\n  }\n}\n\nexport default PersonModel\n","import * as THREE from 'three'\nimport Stats from 'three/examples/jsm/libs/stats.module' // 性能组件\nimport TWEEN from '@tweenjs/tween.js'\n// import { OrbitControls } from 'three/examples/jsm/controls/OrbitControls'\nimport { MapControls } from './pulgins/MapControls' // 相机控制器, 已被官方移除 但好用\nimport { OutlinePass } from 'three/examples/jsm/postprocessing/OutlinePass'\nimport { RenderPass } from 'three/examples/jsm/postprocessing/RenderPass'\nimport { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer'\nimport { PointerLockControls } from 'three/examples/jsm/controls/PointerLockControls'\nimport GltfModel from './GltfModel'\nimport { ObjectSelect } from './ObjectSelect';\nimport { Route } from './Route'\nimport { RouteLine } from './RouteLine'\nimport AGVCar from './AGVCar'\nimport PersonModel from './personModel';\nimport * as CANNON from 'cannon-es'\nclass Store3D {\n  constructor() {\n    this.scene = null;//场景\n    this.camera = null;//相机\n    this.renderer = null;//渲染器\n    this.orbitControl = null\n    this.objects = [];//场景中所有对象的集合\n    this.firstTime = 1;//标记程序第一次运行\n    this.time = 0;//标记AGV小车运行的时间\n    this.roomRateShow = 1;//是否显示空间利用率\n    this.goodTypes = [];//存储所有的库位类型\n    this.objectsRoomRate = [];//显示空间使用率时的所有对象的集合\n    this.velocity = new THREE.Vector3();//\n    this.direction = new THREE.Vector3();//第一人称运动的方向\n    this.prevTime = performance.now();//上一次render的时间\n    this.moveForward = false;//是否向前运行\n    this.moveBackward = false;//是否向后运行\n    this.moveLeft = false;//是否向左运行\n    this.moveRight = false;//是否向右运行\n    this.canJump = false;//是否可以跳\n    this.objectLockPointer = [];//由于spirate类型无法通过Raycaster来获取是否点中，这里用来存错所有的spirate对象\n    this.spriteIsShow = 1;\n    this.storeIsShow = 1;//是否显示库房\n    this.groupIsShow = 1;//是否显示排\n    this.shelfIsShow = 1;//是否显示架子\n    this.skyBox = null // 天空盒子\n    this.buildingObjects = {\n      objects: [//AGV小车路径\n        {\n          objName: \"AGVRoute\",\n          objectType: \"route\",\n          points: [\n            // { x: -100, y: 1, z: 50 },\n            // { x: -500, y: 1, z: 50 },\n            // { x: -800, y: 1, z: 50 },\n            // { x: -800, y: 1, z: 420 },\n            // { x: -1400, y: 1, z: 420 },\n            // { x: -1400, y: 1, z: 480 },\n            // { x: -100, y: 1, z: 480 },\n            // { x: -100, y: 1, z: 50 }\n            { x: -87.77039193374166, y: 28, z: -149.68967301478148 },\n            { x: -86.29625542778217, y: 28, z: -147.37658737038709 },\n            { x: -84.72392809392323, y: 28, z: -145.20440236296008 },\n            { x: -84.19328255270113, y: 28, z: -144.00600041251545 },\n            { x: -85.68297814786274, y: 28, z: -142.62387567157188 },\n            { x: -87.10967327557685, y: 28, z: -144.4436401550513 },\n            { x: -88.3224285766881, y: 28, z: -146.17127393590079 },\n            { x: -89.25420647753265, y: 28, z: -147.15669569644288 },\n            { x: -90.56994450449761, y: 28, z: -147.86549145299722 },\n            { x: -92.08329592007794, y: 28, z: -146.54954990067264 },\n            { x: -93.32239227659437, y: 28, z: -145.7743701640501 },\n            { x: -93.94092981053659, y: 28, z: -145.13957498854137 },\n            { x: -94.54107854310807, y: 28, z: -144.71196645549497 },\n            { x: -94.11666865802309, y: 28, z: -144.0864202705672 },\n            { x: -93.24120204664192, y: 28, z: -143.42528784121254 },\n            { x: -92.82511652429176, y: 28, z: -142.63944189904123 },\n            { x: -92.73012600640793, y: 28, z: -142.16064316787103 },\n\n            { x: -93.69826829041304, y: 28, z: -141.40554811247003 },\n            { x: -94.28461366794534, y: 28, z: -140.88020166672612 },\n            { x: -93.51589846439283, y: 28, z: -139.58112633543183 },\n            { x: -92.25604687075987, y: 28, z: -137.70880711649102 },\n            { x: -91.01935860840891, y: 28, z: -136.0878275909687 },\n            { x: -92.4306159263767, y: 28, z: -135.02978443001484 },\n            { x: -94.32924393850449, y: 28, z: -133.77974406691243 },\n            { x: -95.41306191120177, y: 28, z: -132.80428323625742 },\n            { x: -95.96300542026123, y: 28, z: -132.43714835308035 },\n            { x: -98.16138567442687, y: 28, z: -135.1662577353178 },\n            { x: -99.13055805675616, y: 28, z: -136.6176112752607 },\n            { x: -100.18455766647499, y: 28, z: -135.7351726676191 },\n            { x: -102.3283543858391, y: 28, z: -134.12124150988643 },\n            { x: -100.2369579898838, y: 28, z: -130.1078578563907 },\n            { x: -98.02482491584506, y: 28, z: -128.49722011477448 },\n            { x: -96.25804199956815, y: 28, z: -129.70321028765647 },\n            { x: -91.85047211197177, y: 28, z: -134.21793975901087 },\n            { x: -89.63022184209623, y: 28, z: -135.07078214496096 },\n            { x: -85.8992095983462, y: 28, z: -137.03224419506736 },\n            { x: -85.40625278148313, y: 28, z: -136.12072162141482 },\n            { x: -90.0602855186697, y: 28, z: -132.9849305290307 },\n            { x: -92.2537037163749, y: 28, z: -131.4232344630381 }\n          ]\n        }\n      ]\n    }\n    this.cameraPosition = [-1217.9921323680578, 286.08207747770115, 5531.444886966041]\n    this.controlTarget = [-861.6553793837406, 1.452400931130384, 3584.136471305702]\n    this.personDefaultPosition = [-406.50507291207265, -220.10417395265176, 1336.2503571153645]\n    this.personDefaultTarget = [-444.6869098033287, -309.6406521846675, 1000.4230948945715]\n    this.world = null\n    this.defaultMaterial = null\n    this.clock = null\n    this.PersonModels = null\n  }\n  /**\n  * 初始化仓库所有插件\n  */\n  initMain = async function () {\n    this.initScene();\n    this.initCamera();\n    this.initRenderer();\n    this.initOrbitControl();\n    this.setCameraTarget()\n    await this.initWord()\n    this.initStats();\n    this.initAxisHelper();\n    this.initBuilding();\n    await this.initPerson() // 加载人物\n    this.initLight();\n    this.initoutLine();\n    this.initComposer();\n    this.initObjectSelect();\n    this.initAgvCar();\n    this.initReSize(this);\n    this.resetEyes() // 重置视角\n    // this.initPointLockControl(this);\n    // this.initRouteData() // 初始行车路径\n  }\n  initWord = function () {\n    return new Promise(resolve => {\n      this.world = new CANNON.World();\n      this.world.gravity.set(0, -9.8, 0); // 重力\n\n      // 材料\n      this.defaultMaterial = new CANNON.Material(\"default\");\n      const defalutContactMaterial = new CANNON.ContactMaterial(this.defaultMaterial, this.defaultMaterial, {\n        // 关联材料\n        friction: 0, // 摩擦\n        restitution: 0, // 弹性\n      });\n      this.world.addContactMaterial(defalutContactMaterial); // 添加\n\n      // 更新\n      this.clock = new THREE.Clock();\n      resolve(this.world)\n    })\n  }\n  initSub = function (type, no) {\n    this.initScene();\n    this.initCameraSub(type);\n    this.initRenderer();\n    this.initOrbitControl();\n    this.initLight();\n    if (type == 'Store') {\n      this.initSubStore(no);\n    }\n    else if (type == 'StoreGroup') {\n      this.initSubGroup(no);\n    }\n    this.initoutLine();\n    this.initComposer();\n    this.initObjectSelect();\n  }\n  /**\n   * 仓库整体开始运行\n   */\n  start = function () {\n    this.initMain();\n    this.animate();\n  }\n  startSub = function () {\n    this.animateSub();\n  }\n  /**\n   初始化场景，仅仅需要有句话就可以生命一个场景，非常简单\n   **/\n  initScene = function () {\n    this.scene = new THREE.Scene();\n  }\n  initCameraSub = function (type) {\n    this.camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 10000);\n    this.camera.position.z = 800;\n    if (type == 'Store') {\n      this.camera.position.y = 600;\n      this.camera.position.x = 200;\n    }\n    else if (type == 'StoreGroup') {\n      this.camera.position.y = 100;\n      this.camera.position.x = 0;\n    }\n    this.camera.lookAt(new THREE.Vector3(0, 0, 0));\n    this.scene.add(this.camera);\n  }\n  /**\n   初始化场景，因为我们做的工厂模型，尽可能的接近于真实情景，采用透视相机\n   **/\n  initCamera = function () {\n    //声明一个透视相机，\n    // 视角：60，\n    // 纵横比aspect:全屏，使用的是浏览器的宽度/高度\n    //近平面near：0.1\n    //远平面视角far:10000\n    this.camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 32000);\n    /*\n    设置相机位置，注意threejs中的坐标系采用的是右手坐标系\n     */\n    // this.camera.position.set(this.cameraPosition[0], this.cameraPosition[1], this.cameraPosition[2])\n    //相机的朝向\n    // this.camera.lookAt(-32.569205351049234, 1.4524009311303858, -72.17768000030635);\n    //将相机放到场景中\n    this.scene.add(this.camera);\n  }\n  resetEyes = function () { // 重置视角\n    this.cameraMotion(this.cameraPosition[0], this.cameraPosition[1], this.cameraPosition[2], this.controlTarget[0], this.controlTarget[1], this.controlTarget[2])\n  }\n  /**\n   声名渲染器\n   **/\n  initRenderer = function () {\n    this.renderer = new THREE.WebGLRenderer(\n      {\n        antialias: true,//是否开启反锯齿，设置为true开启反锯齿。\n        alpha: true,//是否可以设置背景色透明。\n        logarithmicDepthBuffer: true//模型的重叠部位便不停的闪烁起来。这便是Z-Fighting问题，为解决这个问题，我们可以采用该种方法\n      }\n    );\n    this.renderer.shadowMap.enabled = true // 开启阴影渲染效果\n    // this.renderer.shadowMap.type = THREE.PCFSoftShadowMap  // 这个类型的阴影看起来比较清晰,更加柔和的阴影,防锯齿\n    this.renderer.setSize(window.innerWidth, window.innerHeight);//渲染器的尺寸与windows的尺寸相同\n    this.renderer.setClearColor(0x39609B);//设置渲染的背景颜色\n    this.renderer.setPixelRatio(window.devicePixelRatio);//设置渲染器的分辨率与浏览器电脑本身的分辨率相同\n    //将渲染器添加到我们的网页中，可以将渲染的内容在网页中显示出来\n    let container = document.getElementById(\"container\");\n    container.appendChild(this.renderer.domElement);\n    console.log(this.renderer, '渲染器的数据')\n  }\n  /**\n   * 效果组合器Composer\n   */\n  initComposer = function () {\n    let renderPass = new RenderPass(this.scene, this.camera);\n    this.composer = new EffectComposer(this.renderer);\n    this.composer.addPass(renderPass);\n    this.composer.addPass(this.outlinePass);\n  }\n  /**\n   * 初始化OutLinePass\n   */\n  initoutLine = function () {\n    this.outlinePass = new OutlinePass(new THREE.Vector2(window.innerWidth, window.innerWidth), this.scene, this.camera);\n    // this.outlinePass.edgeStrength = 10;//包围线浓度\n    // this.outlinePass.edgeGlow = 0.1;//边缘线范围\n    // this.outlinePass.edgeThickness = 1;//边缘线浓度\n    // this.outlinePass.pulsePeriod = 2;//包围线闪烁评率\n    // this.outlinePass.visibleEdgeColor.set('#B31985');//包围线颜色\n    // this.outlinePass.hiddenEdgeColor.set('#190a05');//被遮挡的边界线颜色\n    this.outlinePass.edgeStrength = 2.0 // 边框的亮度\n    this.outlinePass.edgeGlow = 4 // 光晕[0,1]\n    this.outlinePass.usePatternTexture = false // 是否使用父级的材质\n    this.outlinePass.edgeThickness = 4.0 // 边框宽度\n    this.outlinePass.downSampleRatio = 1 // 边框弯曲度\n    this.outlinePass.pulsePeriod = 5 // 呼吸闪烁的速度\n    this.outlinePass.visibleEdgeColor.set(parseInt('0x00FFFF')) // 呼吸显示的颜色\n    this.outlinePass.hiddenEdgeColor = new THREE.Color(0, 0, 0) // 呼吸消失的颜色\n    this.outlinePass.renderToScreen = true\n  }\n\n\n  /**\n   * 初始化物体选中控件\n   */\n  initObjectSelect = function () {\n    ObjectSelect(this.scene, this.camera, this.outlinePass, this.orbitControl, this.cameraMotion.bind(this), this.cameraPosition, this.controlTarget, this.PersonModels, [...this.personDefaultPosition, ...this.personDefaultTarget]);\n  }\n  /**\n   * 初始化灯光\n   */\n  initLight = function () {\n    //首先添加个环境光\n    let ambient = new THREE.AmbientLight(0xffffff, 0.6); //AmbientLight,影响整个场景的光源\n    ambient.position.set(0, 0, 0);\n    this.addObject(ambient);\n    // 添加平行光, 平行光类似于太阳光\n    let directionalLight = new THREE.DirectionalLight(0xffffff, 0.6);//模拟远处类似太阳的光源\n    directionalLight.position.set(0, 2000, 1200);\n    directionalLight.castShadow = true // 允许投影\n    directionalLight.onlyShadow = true // 该光源只用来产生阴影\n    directionalLight.shadow.camera.near = 0;\n    directionalLight.shadow.camera.far = 10000;\n    directionalLight.shadow.camera.left = -3000;\n    directionalLight.shadow.camera.right = 3000;\n    directionalLight.shadow.camera.top = 3000;\n    directionalLight.shadow.camera.bottom = -3000\n    directionalLight.shadow.mapSize.width = 10048\t// 阴影贴图宽度设置为1024像素,越大阴影越清晰,越耗费性能\n    directionalLight.shadow.mapSize.height = 10048\t// 阴影贴图高度设置为1024像素,越大阴影越清晰,越耗费性能\n    this.addObject(directionalLight);\n    //设置点光源\n    // let pointLight1 = new THREE.PointLight(0xffffff, 0.3);\n    // pointLight1.position.set(-500, 200, 0);\n    // this.addObject(pointLight1);\n    // let pointLight2 = new THREE.PointLight(0xffffff, 0.3);\n    // pointLight2.position.set(500, 200, 0);\n    // this.addObject(pointLight2);\n  }\n  /**\n   初始化相机控件OrbitControl\n   */\n  initOrbitControl = function () {\n    this.orbitControl = new MapControls(this.camera, this.renderer.domElement);\n    this.orbitControl.enableDamping = true;\n    this.orbitControl.dampingFactor = 0.5;\n    this.orbitControl.autoRotate = true\n    // 视角最小距离\n    this.orbitControl.minDistance = 0;\n    // 视角最远距离\n    this.orbitControl.maxDistance = 2000;\n    // 最大角度\n    this.orbitControl.maxPolarAngle = Math.PI / 2.2;\n    this.orbitControl.mouseButtons = {\n      LEFT: THREE.MOUSE.ROTATE,\n      MIDDLE: THREE.MOUSE.DOLLY,\n      RIGHT: THREE.MOUSE.PAN\n    }\n    this.orbitControl.enableZoom = false;\n    // to disable rotation\n    this.orbitControl.enableRotate = false;\n    // to disable pan\n    this.orbitControl.enablePan = false;\n  }\n  setCameraTarget () {\n    this.orbitControl.target.set(this.controlTarget[0], this.controlTarget[1], this.controlTarget[2])\n  }\n  /**\n   * 初始化性能控件Stats\n   */\n  initStats = function () {\n    this.stats = new Stats();\n    this.stats.domElement.style.position = 'absolute';\n    this.stats.domElement.style.left = '0px';\n    this.stats.domElement.style.up = '0px';\n\n    document.body.appendChild(this.stats.domElement);\n  }\n  /**\n   * 初始化坐标系辅助控件\n   */\n  initAxisHelper = function () {\n    let axes = new THREE.AxisHelper(1000);\n    this.addObject(axes);\n  }\n  // initLabel = function () {\n  //   let label = new Label(\"我们是冠军\", {\n  //     fontsize: 50\n  //   });\n  //   label.position.set(0, 500, 0);\n  //   this.addObject(label);\n  // }\n  /**\n   * 向场景中添加物体，并记录到\n   */\n  addObject = function (object) {\n    this.scene.add(object);\n    this.objects.push(object);\n  }\n  // /**\n  //  * 移动AGV小车\n  //  */\n  // moveAgvCar = function () {\n  //   if (this.curve && this.AgvCar) {\n  //     this.time = this.time + 1;\n  //     let points = this.curve.getPoints(2000);\n  //     let point = points[this.time];\n  //     let point1 = points[this.time + 1];\n  //     if (this.time >= 2000)\n  //       this.time = 0;\n  //     if (point && point.x) {\n\n  //       this.AgvCar.position.set(point.x, 28, point.z);\n  //       this.AgvCar.lookAt(point1.x, 28, point1.z);\n  //     }\n  //   }\n  // }\n\n  /**\n     * 相机缓动\n     */\n  cameraMotion (x, y, z, tarx = 0, tary = 0, tarz = 0) {\n    // 动画起点坐标\n    const tween = new TWEEN.Tween({\n      x1: this.camera.position.x, // 相机当前位置x\n      y1: this.camera.position.y, // 相机当前位置y\n      z1: this.camera.position.z, // 相机当前位置z\n      x2: this.orbitControl.target.x, // 控制当前的中心点x\n      y2: this.orbitControl.target.y, // 控制当前的中心点y\n      z2: this.orbitControl.target.z // 控制当前的中心点z\n    })\n    // 动画终点坐标\n    tween.to({\n      x1: x,\n      y1: y,\n      z1: z,\n      x2: tarx,\n      y2: tary,\n      z2: tarz\n    }, 1000)\n\n    // 每一帧执行函数 、这个地方就是核心了、每变一帧跟新一次页面元素\n    const self = this\n    tween.onUpdate(function (object) {\n      self.camera.position.x = object.x1\n      self.camera.position.y = object.y1\n      self.camera.position.z = object.z1\n      self.orbitControl.target.x = object.x2\n      self.orbitControl.target.y = object.y2\n      self.orbitControl.target.z = object.z2\n      self.orbitControl.update()\n    })\n\n    // 动画完成后的执行函数\n    tween.onComplete(function () {\n    })\n\n    // 动画曲线\n    tween.easing(TWEEN.Easing.Exponential.InOut)\n\n    // 这个函数必须有、这个是启动函数、不加不能启动\n    tween.start()\n\n    tween.update()\n  }\n\n  initPerson = function () {\n    return new Promise((resolve) => {\n      let that = this\n      let person = new PersonModel(this.scene, this.camera, this.orbitControl, that.world, this.objects)\n      person.loadModel().then(res => {\n        that.PersonModels = res\n        resolve(res)\n      })\n    })\n  }\n  /**\n   创建建筑物\n   */\n  initBuilding = function () {\n    let buildings = new GltfModel()\n    buildings.loadModel().then(res => {\n      res.position.set(0, -400, 0)\n      res.scale.set(1, 1, 1)\n      res.name = 'smcyy_jmkl'\n      console.log(res, '建筑模型')\n      this.scene.add(res)\n    })\n    console.log(this.scene, '当前场景')\n    console.log(this.camera.position, '当前相机位置')\n    console.log(this.orbitControl.target, '当前控制器的朝向')\n  }\n  initRouteData = function () {\n    let buildingData = this.buildingObjects.objects;\n    for (let i = 0; i < buildingData.length; i++) {\n      let objectOption = buildingData[i];\n      switch (objectOption.objectType) {\n        case \"route\":\n          this.curve = Route(objectOption)\n          this.addObject(RouteLine(this.curve, objectOption));\n          break;\n      }\n    }\n  }\n  showAgvCar = function (object) {\n    object.name = \"AGV小车\";\n    object.position.set(0, 0, 0);\n    object.visible = false\n    this.AgvCar = object;\n    this.addObject(object);\n  }\n\n  initAgvCar = function () {\n    let agvCar = new AGVCar();\n    agvCar.LoadFBX(this, 'showAgvCar')\n  }\n  setCar = function (visible, position) {\n    let car = this.scene.getObjectByName(\"AGV小车\")\n    car.visible = visible\n    car.position.x = position.x\n    car.position.y = position.y\n    car.position.z = position.z\n  }\n  /**\n   * 显示控件利用率\n   */\n  // showRoomRate = function () {\n  //   let Store3DData = eval('(' + window.localStorage.getItem('Store3DData') + ')');\n  //   if (Store3DData !== null) {\n  //     for (let i = 0; i < Store3DData.Areas.length; i++) {\n\n  //       let optionArea = Store3DData.Areas[i];\n  //       let area = new StoreArea(optionArea);\n  //       for (let j = 0; j < optionArea.Stores.length; j++) {\n  //         let optionStore = optionArea.Stores[j];\n  //         optionStore = CommonFunction.transPosition(optionStore, optionArea);\n  //         for (let k = 0; k < optionStore.Groups.length; k++) {\n  //           let optionGroup = optionStore.Groups[k];\n  //           optionGroup = CommonFunction.transPosition(optionGroup, optionStore);\n  //           let height = optionGroup.Height * (optionGroup.OccurpyBinNum / optionGroup.TotalBinNum);\n\n  //           optionGroup.Height = 1;\n  //           optionGroup.Position.Y = 1;\n  //           let group = new StoreGroup(optionGroup, 2);\n  //           this.addObject(group);\n  //           this.objectsRoomRate.push(group);\n  //           var tween1 = new TWEEN.Tween(group.scale).to({\n  //             y: height\n  //           }, 3000).easing(TWEEN.Easing.Quadratic.In).onComplete(function () {\n  //           });\n  //           var tween2 = new TWEEN.Tween(group.position).to({\n  //             y: height / 2\n  //           }, 3000).easing(TWEEN.Easing.Quadratic.In).onComplete(function () {\n  //           });\n  //           tween1.start();\n  //           tween2.start();\n  //         }\n  //       }\n  //     }\n  //   }\n  // }\n  /**\n   * 根据ID或者名称移除对象\n   */\n  removeObject = function (nameorid) {\n    for (let i = 0; i < this.objects.length; i++) {\n      let tmpObject = this.objects[i];\n      if (tmpObject.name == nameorid || tmpObject.id == nameorid) {\n        this.objects.splice(i, 1);\n        this.scene.remove(tmpObject);\n      }\n\n    }\n  }\n  /**\n   * 显示或者隐温度控件\n   */\n  changeTemperatureShow = function () {\n    if (this.tmpIsShow == 1) {\n      for (let i = 0; i < this.objectLockPointer.length; i++) {\n        let tmpObject = this.objectLockPointer[i];\n        if (tmpObject.type == \"Temperature\") {\n          this.removeObject(tmpObject.id);\n        }\n        else if (tmpObject.type == \"StoreSign\") {\n          this.addObject(tmpObject);\n        }\n      }\n      this.tmpIsShow = 0;\n    }\n    else {\n      for (let i = 0; i < this.objectLockPointer.length; i++) {\n        let tmpObject = this.objectLockPointer[i];\n        if (tmpObject.type == \"Temperature\") {\n          this.addObject(tmpObject);\n        }\n        else if (tmpObject.type == \"StoreSign\") {\n          this.removeObject(tmpObject.id);\n        }\n      }\n      this.tmpIsShow = 1;\n    }\n  }\n  /**\n   * 显示空间利用率\n   */\n  changeRoomRateShow = function () {\n    //显示空间利用率\n    if (this.roomRateShow == 1) {\n      //隐藏架子\n      for (let i = 0; i < this.objects.length; i++) {\n        let tmpObject = this.objects[i];\n        if (\n          tmpObject.type == \"StoreShelf\" ||\n          tmpObject.type == \"StoreGoods\") {\n          this.scene.remove(tmpObject);\n        }\n      }\n      this.showRoomRate();\n      this.roomRateShow = 0;\n    }\n    //隐藏空间\n    else {\n      for (let i = 0; i < this.objects.length; i++) {\n        let tmpObject = this.objects[i];\n        if (tmpObject.type == \"StoreShelf\" ||\n          tmpObject.type == \"StoreGoods\") {\n          this.scene.add(tmpObject);\n        }\n      }\n      for (let j = 0; j < this.objectsRoomRate.length; j++) {\n        let tmpObject = this.objectsRoomRate[j];\n        this.removeObject(tmpObject.id);\n      }\n      this.objectsRoomRate = [];\n      this.roomRateShow = 1;\n    }\n  }\n  //显示空间利用率\n  // showRoomRate = function () {\n\n  //   let Store3DData = eval('(' + window.localStorage.getItem('Store3DData') + ')');\n  //   if (Store3DData !== null) {\n  //     for (let i = 0; i < Store3DData.Areas.length; i++) {\n\n  //       let optionArea = Store3DData.Areas[i];\n  //       let area = new StoreArea(optionArea);\n  //       for (let j = 0; j < optionArea.Stores.length; j++) {\n  //         let optionStore = optionArea.Stores[j];\n  //         optionStore.Position = CommonFunction.transPosition(optionStore.Position, optionArea.Position);\n  //         for (let k = 0; k < optionStore.Groups.length; k++) {\n  //           let optionGroup = optionStore.Groups[k];\n  //           optionGroup.Position = CommonFunction.transPosition(optionGroup.Position, optionStore.Position);\n  //           let height = optionGroup.Height * (optionGroup.OccurpyBinNum / optionGroup.TotalBinNum);\n\n  //           let group = new StoreGroup(optionGroup);\n  //           this.addObject(group);\n  //           this.objectsRoomRate.push(group);\n  //           optionGroup.Height = 1;\n  //           optionGroup.Position.Y = 1;\n  //           let groupRate = new StoreGroup(optionGroup, 2);\n  //           this.addObject(groupRate);\n\n  //           this.objectsRoomRate.push(groupRate);\n  //           var tween1 = new TWEEN.Tween(groupRate.scale).to({\n  //             y: height\n  //           }, 3000).easing(TWEEN.Easing.Quadratic.In).onComplete(function () {\n  //           });\n  //           var tween2 = new TWEEN.Tween(groupRate.position).to({\n  //             y: height / 2\n  //           }, 3000).easing(TWEEN.Easing.Quadratic.In).onComplete(function () {\n  //           });\n  //           tween1.start();\n  //           tween2.start();\n  //         }\n  //       }\n  //     }\n  //   }\n  // }\n  /***********************************************\n   * 隐藏或者显示所有的仓库对象\n   */\n  changeStoreShow = function () {\n    if (this.storeIsShow == 1) {\n      for (let i = 0; i < this.objects.length; i++) {\n        let tmpObject = this.objects[i];\n        if (tmpObject.type == \"Store\") {\n          this.scene.remove(tmpObject);\n        }\n      }\n      this.storeIsShow = 0;\n    } else {\n      for (let i = 0; i < this.objects.length; i++) {\n        let tmpObject = this.objects[i];\n        if (tmpObject.type == \"Store\") {\n          this.scene.add(tmpObject);\n        }\n      }\n      this.storeIsShow = 1;\n    }\n  }\n  /***********************************************\n   * 隐藏或者显示所有的巷道对象\n   */\n  // changeGroupShow = function () {\n  //   if (this.groupIsShow == 1) {\n  //     for (let i = 0; i < this.objects.length; i++) {\n  //       let tmpObject = this.objects[i];\n  //       if (tmpObject.type == \"StoreGroup\") {\n  //         this.scene.remove(tmpObject);\n  //       }\n  //     }\n  //     this.groupIsShow = 0;\n  //   }\n  //   else {\n  //     for (let i = 0; i < this.objects.length; i++) {\n  //       let tmpObject = this.objects[i];\n  //       if (tmpObject.type == \"StoreGroup\") {\n  //         this.scene.add(tmpObject);\n  //       }\n  //     }\n  //     this.groupIsShow = 1;\n  //   }\n  // }\n  /***********************************************\n   * 隐藏或者显示所有仓库框架\n   */\n  changeShelfShow = function () {\n    if (this.shelfIsShow == 1) {\n      for (let i = 0; i < this.objects.length; i++) {\n        let tmpObject = this.objects[i];\n        if (tmpObject.type == \"StoreShelf\") {\n          this.scene.remove(tmpObject);\n        }\n      }\n      this.shelfIsShow = 0;\n    }\n    else {\n      for (let i = 0; i < this.objects.length; i++) {\n        let tmpObject = this.objects[i];\n        if (tmpObject.type == \"StoreShelf\") {\n          this.scene.add(tmpObject);\n        }\n      }\n      this.shelfIsShow = 1;\n    }\n  }\n  /**\n   * 初始化仓库每排\n   */\n  // initSubGroup = function (No) {\n  //   let dataAnalyze = new DataAnalyze();\n  //   let group = new THREE.Group();\n\n  //   if (this.firstTime == 1) {\n  //     var optionGroup = dataAnalyze.getGroup(No);\n  //     optionGroup.Position.X = 0;\n  //     optionGroup.Position.Y = 0;\n  //     optionGroup.Position.Z = 0;\n  //     let shelf = new StoreShelf(optionGroup); group.add(shelf);\n  //     group.add(shelf);\n  //     //显示库位上的货物\n  //     for (let m = 0; m < optionGroup.Bins.length; m++) {\n  //       let optionBin = optionGroup.Bins[m];\n  //       let existGoods = this.getExistedGoodType(optionBin.State);\n  //       let storeGoods = new StoreGoods(optionGroup, optionBin);\n  //       if (existGoods == null) {\n  //         let goods = storeGoods.create();\n  //         group.add(goods);\n  //         this.goodTypes.push({ type: optionBin.State, object: goods });\n  //       } else {\n  //         let goods = storeGoods.clone(existGoods);\n  //         group.add(goods);\n  //       }\n  //     }\n  //     group.rotation.y = -0.5 * Math.PI;\n  //     this.addObject(group);\n  //   }\n  // }\n  /**\n   * 初始化子仓库\n   */\n  // initSubStore = function (No) {\n  //   let dataAnalyze = new DataAnalyze();\n  //   if (this.firstTime == 1) {\n  //     var storeOption = dataAnalyze.getStore(No);\n  //     storeOption.Position.Y = 0;\n  //     storeOption.Position.X = 0;\n  //     //显示每行信息\n  //     for (let k = 0; k < storeOption.Groups.length; k++) {\n  //       let optionGroup = storeOption.Groups[k];\n  //       optionGroup.Position = CommonFunction.transPosition(optionGroup.Position, storeOption.Position);\n  //       let shelf = new StoreShelf(optionGroup);\n  //       let group = new StoreGroup(optionGroup, 1);\n  //       this.addObject(shelf);\n  //       this.addObject(group);\n  //       //显示库位上的货物\n  //       for (let m = 0; m < optionGroup.Bins.length; m++) {\n  //         let optionBin = optionGroup.Bins[m];\n  //         let existGoods = this.getExistedGoodType(optionBin.State);\n  //         let storeGoods = new StoreGoods(optionGroup, optionBin);\n  //         if (existGoods == null) {\n  //           let goods = storeGoods.create();\n  //           this.addObject(goods);\n  //           this.goodTypes.push({ type: optionBin.State, object: goods });\n  //         } else {\n  //           let goods = storeGoods.clone(existGoods);\n  //           this.addObject(goods);\n  //         }\n  //       }\n  //     }\n  //   }\n  //   this.firstTime = 0;\n  // }\n  /**\n   * 初始化仓库相关对象\n   */\n  // initStoreObjects = function (object) {\n\n\n  //   if (this.firstTime == 1) {\n  //     let Store3DData = eval('(' + window.localStorage.getItem('Store3DData') + ')');\n  //     if (Store3DData !== null) {\n  //       //显示仓库区域\n  //       for (let i = 0; i < Store3DData.Areas.length; i++) {\n  //         let optionArea = Store3DData.Areas[i];\n  //         let area = new StoreArea(optionArea);\n  //         object.addObject(area);\n  //         //显示仓库\n  //         for (let j = 0; j < optionArea.Stores.length; j++)//\n  //         {\n  //           let optionStore = optionArea.Stores[j];\n  //           optionStore.Position = CommonFunction.transPosition(optionStore.Position, optionArea.Position);\n  //           let store = new Store(optionStore);\n  //           object.addObject(store);\n  //           let storeSign = new StoreSign(optionStore, this);\n  //           let storeTemperature = new Temperature(optionStore, this);\n  //           //显示每行信息\n  //           for (let k = 0; k < optionStore.Groups.length; k++) {\n  //             let optionGroup = optionStore.Groups[k];\n  //             optionGroup.Position = CommonFunction.transPosition(optionGroup.Position, optionStore.Position);\n  //             let shelf = new StoreShelf(optionGroup);\n  //             let group = new StoreGroup(optionGroup, 1);\n  //             object.addObject(shelf);\n  //             object.addObject(group);\n  //             //显示库位上的货物\n  //             for (let m = 0; m < optionGroup.Bins.length; m++) {\n  //               let optionBin = optionGroup.Bins[m];\n  //               let existGoods = this.getExistedGoodType(optionBin.State);\n  //               let storeGoods = new StoreGoods(optionGroup, optionBin);\n  //               if (existGoods == null) {\n  //                 let goods = storeGoods.create();\n  //                 object.addObject(goods);\n  //                 this.goodTypes.push({ type: optionBin.State, object: goods });\n  //               }\n  //               else {\n  //                 let goods = storeGoods.clone(existGoods);\n  //                 object.addObject(goods);\n  //               }\n  //             }\n  //           }\n\n  //         }\n  //       }\n  //       this.firstTime = 0;\n  //     }\n  //   }\n  // }\n\n  /*******************************************************************************\n   * 改变背景，是否添加背景盒子\n   *******************************************************************************/\n  changeBackGround = function () {\n    if (this.scene.getObjectByName('StarSky', false) == undefined) {\n      this.addObject(this.skyBox);\n    } else {\n      this.removeObject(this.skyBox.name);\n    }\n  }\n\n\n  /**\n   * 获取是否已经生成同类型的货物\n   */\n  getExistedGoodType = function (state) {\n    for (let i = 0; i < this.goodTypes.length; i++) {\n      let type = this.goodTypes[i];\n      if (type.type === state) {\n        return type.object;\n      }\n\n    }\n    return null;\n\n  }\n  /**\n   *显示或者隐藏所有sprite控件\n   */\n  changeSpriteShow = function () {\n    if (this.spriteIsShow == 1) {\n      for (let i = 0; i < this.objectLockPointer.length; i++) {\n        let tmpObject = this.objectLockPointer[i];\n        this.removeObject(tmpObject.id);\n      }\n      this.spriteIsShow = 0;\n    }\n    else {\n      for (let i = 0; i < this.objectLockPointer.length; i++) {\n        let tmpObject = this.objectLockPointer[i];\n        this.addObject(tmpObject);\n      }\n      this.spriteIsShow = 1;\n    }\n  }\n\n\n  /**\n   * 初始化PointLockControl\n   * 设置鼠标控制\n   */\n  initPointLockControl = function (object) {\n    this.lockcontrols = new PointerLockControls(this.camera);\n    this.raycaster = new THREE.Raycaster(new THREE.Vector3(), new THREE.Vector3(0, - 1, 0), 0, 10);\n\n    var onKeyDown = function (event) {\n      switch (event.keyCode) {\n\n        case 38: // up\n        case 87: // w\n          object.moveForward = true;\n          break;\n\n        case 37: // left\n        case 65: // a\n          object.moveLeft = true;\n          break;\n\n        case 40: // down\n        case 83: // s\n          object.moveBackward = true;\n          break;\n\n        case 39: // right\n        case 68: // d\n          object.moveRight = true;\n          break;\n\n        case 32: // space\n          if (object.canJump === true) object.velocity.y += 350;\n          object.canJump = false;\n          break;\n\n      }\n\n\n    };\n    var onKeyUp = function (event) {\n\n      switch (event.keyCode) {\n\n        case 38: // up\n        case 87: // w\n          object.moveForward = false;\n          break;\n\n        case 37: // left\n        case 65: // a\n          object.moveLeft = false;\n          break;\n\n        case 40: // down\n        case 83: // s\n          object.moveBackward = false;\n          break;\n\n        case 39: // right\n        case 68: // d\n          object.moveRight = false;\n          break;\n\n      }\n\n    };\n    document.addEventListener('keydown', onKeyDown, false);\n    document.addEventListener('keyup', onKeyUp, false);\n  }\n\n  /**\n   * 开启鼠标锁定\n   */\n  lockControl = function () {\n    if (this.spriteIsShow == 1) {\n      this.changeSpriteShow();\n    }\n    this.camera.position.y = 100;\n    this.camera.lookAt(0, 100, 0);\n    this.lockcontrols.getObject().position.x = 0;\n    this.lockcontrols.getObject().position.y = 100;\n    this.lockcontrols.getObject().position.z = 580;\n    this.lockcontrols.lock();\n  }\n\n  /**\n   * 第一人称视角移动\n   */\n  firstPersonMove = function () {\n\n    if (this.lockcontrols.isLocked === true) {\n      this.raycaster.ray.origin.copy(this.lockcontrols.getObject().position);\n      this.raycaster.ray.origin.y -= 10;\n      var intersections = this.raycaster.intersectObjects(this.objects);\n      var onObject = intersections.length > 0;\n      var time = performance.now();\n      var delta = (time - this.prevTime) / 1000;\n      this.velocity.x -= this.velocity.x * 10.0 * delta;\n      this.velocity.z -= this.velocity.z * 10.0 * delta;\n      this.velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\n\n      this.direction.z = Number(this.moveForward) - Number(this.moveBackward);\n      this.direction.x = Number(this.moveLeft) - Number(this.moveRight);\n      this.direction.normalize(); // this ensures consistent movements in all directions\n\n      if (this.moveForward || this.moveBackward) this.velocity.z -= this.direction.z * 2000.0 * delta;\n      if (this.moveLeft || this.moveRight) this.velocity.x -= this.direction.x * 2000.0 * delta;\n\n      if (onObject === true) {\n\n        this.velocity.y = Math.max(0, this.velocity.y);\n        this.canJump = true;\n\n      }\n      this.lockcontrols.getObject().translateX(this.velocity.x * delta);\n      this.lockcontrols.getObject().position.y += (this.velocity.y * delta); // new behavior\n      this.lockcontrols.getObject().translateZ(this.velocity.z * delta);\n\n      if (this.lockcontrols.getObject().position.y < 100) {\n\n        this.velocity.y = 0;\n        this.lockcontrols.getObject().position.y = 100;\n        this.canJump = true;\n      }\n      this.prevTime = time;\n    }\n  }\n  /**\n   * 显示或者隐藏性能控件\n   */\n  changeStats = function () {\n    if (this.stats.domElement.style.display == 'none')\n      this.stats.domElement.style.display = 'block';\n    else\n      this.stats.domElement.style.display = 'none';\n  }\n  /**\n   * 浏览器窗口尺寸变化\n   */\n  initReSize = function (object) {\n    window.addEventListener('resize', function () {\n      object.camera.aspect = window.innerWidth / window.innerHeight;\n      object.camera.updateProjectionMatrix();\n      object.renderer.setSize(window.innerWidth, window.innerHeight);\n    }, false);\n  }\n  /**\n   * 定时重复刷新\n   */\n  animate = function () {\n    requestAnimationFrame(this.animate.bind(this));\n    this.renderer.render(this.scene, this.camera);\n    // this.firstPersonMove();\n    this.stats.update();\n    this.composer.render();\n    TWEEN.update();\n    const dt = this.clock.getDelta();\n    dt > 0 && this.world.step(dt);\n    // this.initStoreObjects(this);\n    // this.moveAgvCar();\n  }\n  animateSub = function () {\n    requestAnimationFrame(this.animateSub.bind(this));\n    this.renderer.render(this.scene, this.camera);\n    this.composer.render();\n    const dt = this.clock.getDelta();\n    dt > 0 && this.world.step(dt);\n  }\n}\n\nexport default Store3D\n","<template>\n  <div>\n    <div id=\"container\" ref=\"threeMapDialog\">\n    </div>\n    <div class=\"view\">\n      <div @click=\"reset\">全局视角</div>\n      <div :class=\"index === currentIndex ? 'blue': ''\" v-for=\"(item,index) in list\" @click=\"chooseRoom(index)\" :key=\"index\">{{item}}</div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Store3D from '../utils/three'\nlet map = null\nexport default {\n  name: 'Home',\n  data () {\n    return {\n      list: ['岛屿1','岛屿2','岛屿3','岛屿4'],\n      currentIndex: null, // 当前选择岛屿\n      room0cameraPosition:[28.43003964176088, 1.452889762713346, 304.39723202981133],\n      room0controlTarget:[28.429775084701777, 1.4524009311303967, 304.3964701944072],\n      room1cameraPosition:[341.3187824529851, 258.589532381425, 29.96280443327055],\n      room1controlTarget:[-134.67617024276637, 1.4524009311304222, -189.90002092587525],\n      room2cameraPosition:[679.483074222167, 1.4524009311308381, -147.06661768887224],\n      room2controlTarget:[679.483074222166, 1.4524009311303852, -147.0666176888725],\n      room3cameraPosition:[9.87853230093765, 212.84370573178734, -500.05727486924764],\n      room3controlTarget:[-338.33665224294924, 1.4524009311303825, -519.3413577005416],\n      room0Person:{x: 35.396950189773655,y: -112.01401222885976,z: 219.85335656254063},\n      room1Person:{x: 272.05169551814424,y: 172.35301065548248,z: -22.821989980502224},\n      room2Person:{x: 530.5205816513906,y: -100.545571007452,z: -185.17160492442656},\n      room3Person:{x: -45.64095606463366,y: 142.84145836751168,z: -487.8489716493898}\n    }\n  },\n  created() {\n  },\n  mounted() {\n    this.mapInit() \n  },\n  methods:{\n    mapInit() { // 初始地图\n      map = new Store3D()\n      map.start()\n    },\n    chooseRoom(item) { // 选择岛屿\n      this.currentIndex = item\n      if (item === 0) {\n        map.cameraMotion(this.room0cameraPosition[0],this.room0cameraPosition[1],this.room0cameraPosition[2],this.room0controlTarget[0],this.room0controlTarget[1],this.room0controlTarget[2])\n        map.setCar(true,this.room0Person)\n      }\n      if (item === 1) {\n        map.cameraMotion(this.room1cameraPosition[0],this.room1cameraPosition[1],this.room1cameraPosition[2],this.room1controlTarget[0],this.room1controlTarget[1],this.room1controlTarget[2])\n        map.setCar(true,this.room1Person)\n      }\n      if (item === 2) {\n        map.cameraMotion(this.room2cameraPosition[0],this.room2cameraPosition[1],this.room2cameraPosition[2],this.room2controlTarget[0],this.room2controlTarget[1],this.room2controlTarget[2])\n        map.setCar(true,this.room2Person)\n      }\n      if (item === 3) {\n        map.cameraMotion(this.room3cameraPosition[0],this.room3cameraPosition[1],this.room3cameraPosition[2],this.room3controlTarget[0],this.room3controlTarget[1],this.room3controlTarget[2])\n        map.setCar(true,this.room3Person)\n      }\n    },\n    reset(){\n      this.currentIndex = null\n      map.resetEyes() // 重置视角\n      map.setCar(false,{x: 0,y: 0,z: 0})\n    }\n  }\n}\n</script>\n\n<style scoped>\n.view {\n  width: 100px;\n  height: auto;\n  position: fixed;\n  right: 20px;\n  top: 20px;\n  line-height: 40px;\n  color: #fff;\n  cursor: pointer;\n}\n.view .blue {\n  border: 1px solid;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./home.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./home.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./home.vue?vue&type=template&id=8ba45596&scoped=true&\"\nimport script from \"./home.vue?vue&type=script&lang=js&\"\nexport * from \"./home.vue?vue&type=script&lang=js&\"\nimport style0 from \"./home.vue?vue&type=style&index=0&id=8ba45596&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"8ba45596\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div id=\"app\">\n    <home />\n  </div>\n</template>\n\n<script>\nimport home from './components/home.vue'\n\nexport default {\n  name: 'App',\n  components: {\n    home\n  }\n}\n</script>\n\n<style>\n#app {\n  font-family: Avenir, Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n}\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=650470a0&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\nimport App from './App.vue'\n\nVue.config.productionTip = false\n\nnew Vue({\n  render: h => h(App),\n}).$mount('#app')\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./home.vue?vue&type=style&index=0&id=8ba45596&scoped=true&lang=css&\""],"sourceRoot":""}